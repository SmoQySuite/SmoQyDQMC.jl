<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SmoQyDQMC.jl</title><meta name="title" content="API · SmoQyDQMC.jl"/><meta property="og:title" content="API · SmoQyDQMC.jl"/><meta property="twitter:title" content="API · SmoQyDQMC.jl"/><meta name="description" content="Documentation for SmoQyDQMC.jl."/><meta property="og:description" content="Documentation for SmoQyDQMC.jl."/><meta property="twitter:description" content="Documentation for SmoQyDQMC.jl."/><meta property="og:url" content="https://smoqysuite.github.io/SmoQyDQMC.jl/stable/api/"/><meta property="twitter:url" content="https://smoqysuite.github.io/SmoQyDQMC.jl/stable/api/"/><link rel="canonical" href="https://smoqysuite.github.io/SmoQyDQMC.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SmoQyDQMC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../hamiltonian/">Supported Hamiltonians</a></li><li><a class="tocitem" href="../simulation_output/">Simulation Output Overview</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Simulation-Information-Type-and-Methods"><span>Simulation Information Type and Methods</span></a></li><li><a class="tocitem" href="#Model-Geometry-Type-and-Methods"><span>Model Geometry Type and Methods</span></a></li><li><a class="tocitem" href="#Fermion-Path-Integral-Type-and-Methods"><span>Fermion Path Integral Type and Methods</span></a></li><li><a class="tocitem" href="#Update-Numerical-Stabilization-Frequency"><span>Update Numerical Stabilization Frequency</span></a></li><li><a class="tocitem" href="#Tight-Binding-Model"><span>Tight-Binding Model</span></a></li><li><a class="tocitem" href="#Hubbard-Model"><span>Hubbard Model</span></a></li><li><a class="tocitem" href="#Electron-Phonon-Model"><span>Electron-Phonon Model</span></a></li><li><a class="tocitem" href="#Density-and-Chemical-Potential-Tuning"><span>Density and Chemical Potential Tuning</span></a></li><li><a class="tocitem" href="#Measurement-Methods"><span>Measurement Methods</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/hubbard_chain/">Tutorial 1: Hubbard Chain</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/hubbard_chain/">Hubbard Chain</a></li><li><a class="tocitem" href="../examples/hubbard_chain_mpi/">Hubbard Chain with MPI</a></li><li><a class="tocitem" href="../examples/hubbard_chain_checkpoint/">Hubbard Chain with Checkpointing</a></li><li><a class="tocitem" href="../examples/holstein_chain/">Holstein Chain with Density Tuning</a></li><li><a class="tocitem" href="../examples/ossh_chain/">Optical Su-Schrieffer-Heeger Chain</a></li><li><a class="tocitem" href="../examples/bssh_chain/">Bond Su-Schrieffer-Heeger Chain</a></li><li><a class="tocitem" href="../examples/hubbard_holstein_square/">Square Hubbard-Holstein Model</a></li><li><a class="tocitem" href="../examples/hubbard_threeband/">Three-Band Hubbard Model</a></li><li><a class="tocitem" href="../examples/holstein_kagome/">Kagome Holstein Model with Density Tuning</a></li><li><a class="tocitem" href="../examples/hubbard_honeycomb/">Honeycomb Hubbard model</a></li><li><a class="tocitem" href="../examples/holstein_zeeman_square/">Square Holstein Model with Zeeman Splitting</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Simulation-Information-Type-and-Methods"><a class="docs-heading-anchor" href="#Simulation-Information-Type-and-Methods">Simulation Information Type and Methods</a><a id="Simulation-Information-Type-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Information-Type-and-Methods" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.SimulationInfo"><code>SimulationInfo</code></a></li><li><a href="#SmoQyDQMC.initialize_datafolder"><code>initialize_datafolder</code></a></li><li><a href="#SmoQyDQMC.model_summary"><code>model_summary</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.SimulationInfo" href="#SmoQyDQMC.SimulationInfo"><code>SmoQyDQMC.SimulationInfo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimulationInfo</code></pre><p>Contains identification information about simulation, including the location data is written to, the simulation ID, and MPI process ID, and whether this simulation started a new simulation or resumed a previous simulation.</p><p><strong>Fields</strong></p><ul><li><code>filepath::String</code>: File path to where data folder lives.</li><li><code>datafolder_prefix</code>: Prefix for the data folder name.</li><li><code>datafolder_name::String</code>: The data folder name, given by <code>$(datafolder_prefix)_$(sID)</code>.</li><li><code>datafolder::String</code>: The data folder, including filepath, given by <code>joinpath(filepath, datafolder_name)</code>.</li><li><code>pID::Int</code>: MPI process ID, defaults to 0 if MPI not being used.</li><li><code>sID::Int</code>: Simulation ID.</li><li><code>resuming::Bool</code>: Whether current simulation is resuming a previous simulation (<code>true</code>) or starting a new one (<code>false</code>).</li><li><code>smoqy_version::VersionNumber</code>: Version of <a href="https://github.com/SmoQySuite/SmoQyDQMC.jl">SmoQyDQMC.jl</a> used in simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/SimulationInfo.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.SimulationInfo-Tuple{}" href="#SmoQyDQMC.SimulationInfo-Tuple{}"><code>SmoQyDQMC.SimulationInfo</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimulationInfo(; datafolder_prefix::String, filepath::String = &quot;.&quot;, sID::Int=0, pID::Int=0)</code></pre><p>Initialize and return in instance of the type <a href="#SmoQyDQMC.SimulationInfo"><code>SimulationInfo</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/SimulationInfo.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_datafolder" href="#SmoQyDQMC.initialize_datafolder"><code>SmoQyDQMC.initialize_datafolder</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_datafolder(sim_info::SimulationInfo)</code></pre><p>Initalize <code>sim_info.datafolder</code> directory if it does not already exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/SimulationInfo.jl#L108-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.model_summary" href="#SmoQyDQMC.model_summary"><code>SmoQyDQMC.model_summary</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model_summary(;
    simulation_info::SimulationInfo,
    β::T, Δτ::T, model_geometry::ModelGeometry,
    tight_binding_model::Union{TightBindingModel,Nothing} = nothing,
    tight_binding_model_up::Union{TightBindingModel,Nothing} = nothing,
    tight_binding_model_dn::Union{TightBindingModel,Nothing} = nothing,
    interactions::Tuple
) where {T&lt;:AbstractFloat}</code></pre><p>Write model to summary to file. Note that either <code>tight_binding_model</code> or <code>tight_binding_model_up</code> and <code>tight_binding_model_dn</code> need to be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/model_summary.jl#L1-L13">source</a></section></article><h2 id="Model-Geometry-Type-and-Methods"><a class="docs-heading-anchor" href="#Model-Geometry-Type-and-Methods">Model Geometry Type and Methods</a><a id="Model-Geometry-Type-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Geometry-Type-and-Methods" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.ModelGeometry"><code>ModelGeometry</code></a></li><li><a href="#SmoQyDQMC.add_bond!"><code>add_bond!</code></a></li><li><a href="#SmoQyDQMC.get_bond_id"><code>get_bond_id</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ModelGeometry" href="#SmoQyDQMC.ModelGeometry"><code>SmoQyDQMC.ModelGeometry</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelGeometry{D, T&lt;:AbstractFloat, N}</code></pre><p>Contains all the information defining the lattice geometry for the model in <code>D</code> spatial dimensions.</p><p><strong>Comment</strong></p><p>The bond ID associated with a <code>bond::Bond{D}</code> corresponds to the index associated with it into the <code>bonds</code> vector field.</p><p><strong>Fields</strong></p><ul><li><code>unit_cell::UnitCell{D,T,N}</code>: Defines unit cell.</li><li><code>lattice::Lattice{D}</code>: Defines finite lattice extent.</li><li><code>bonds::Vector{Bond{D}}</code>: All available bond definitions in simulation, with vector indices giving the bond ID.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ModelGeometry.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ModelGeometry-Union{Tuple{D}, Tuple{UnitCell{D}, Lattice{D}}} where D" href="#SmoQyDQMC.ModelGeometry-Union{Tuple{D}, Tuple{UnitCell{D}, Lattice{D}}} where D"><code>SmoQyDQMC.ModelGeometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelGeometry(unit_cell::UnitCell, lattice::Lattice)</code></pre><p>Initialize and return a <a href="#SmoQyDQMC.ModelGeometry"><code>ModelGeometry</code></a> instance. Defines a &quot;trivial&quot; bond defintion for each orbital in the unit cell that connects an orbital to itself.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ModelGeometry.jl#L23-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.add_bond!" href="#SmoQyDQMC.add_bond!"><code>SmoQyDQMC.add_bond!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>add<em>bond!(model</em>geometry::ModelGeometry{D,T}, bond::Bond{D}) where {D, T}   </p><p>Add <code>bond</code> definition to <code>model_geometry</code>, returning the bond ID i.e. the index to <code>bond</code> in the vector <code>model_geometry.bonds</code>. This method first checks that <code>bond</code> is not already defined. If it is this method simply returns the corresponding bond ID. If <code>bond</code> is not already defined, then it is appended to the vector <code>model_geometry.bonds</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ModelGeometry.jl#L87-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.get_bond_id" href="#SmoQyDQMC.get_bond_id"><code>SmoQyDQMC.get_bond_id</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bond_id(model_geometry::ModelGeometry{D,T}, bond::Bond{D}) where {D, T}</code></pre><p>Return the bond ID associated with the bond defintion <code>bond</code>, returning <code>bond_id=0</code> if the it is not a recorded bond.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ModelGeometry.jl#L115-L120">source</a></section></article><h2 id="Fermion-Path-Integral-Type-and-Methods"><a class="docs-heading-anchor" href="#Fermion-Path-Integral-Type-and-Methods">Fermion Path Integral Type and Methods</a><a id="Fermion-Path-Integral-Type-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Fermion-Path-Integral-Type-and-Methods" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a></li><li><a href="#SmoQyDQMC.initialize_propagators"><code>initialize_propagators</code></a></li><li><a href="#SmoQyDQMC.calculate_propagators!"><code>calculate_propagators!</code></a></li><li><a href="#SmoQyDQMC.calculate_propagator!"><code>calculate_propagator!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.FermionPathIntegral" href="#SmoQyDQMC.FermionPathIntegral"><code>SmoQyDQMC.FermionPathIntegral</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FermionPathIntegral{T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>A type to represent a fermion path integral. In particular, this type contains the information required to reconstruct the diagonal on-site energy matrices <span>$V_l$</span> and hopping matrices <span>$K_l$</span> for each imaginary time slice <span>$l \in [1, L_\tau],$</span> where <span>$\tau = \Delta\tau \cdot l$</span> and <span>$\beta = \Delta\tau \cdot L_\tau.$</span></p><p><strong>Fields</strong></p><ul><li><code>β::E</code>: Inverse temperature.</li><li><code>Δτ::E</code>: Discretization in imaginary time.</li><li><code>Lτ::Int</code>: Length of the imaginary time axis.</li><li><code>N::Int</code>: Number of orbitals in the lattice.</li><li><code>neighbor_table::Matrix{Int}</code>: Neighbor table for each pair of orbitals in the lattice connected by a hopping.</li><li><code>t::Matrix{T}</code>: Hopping amplitudes for imaginary-time slice <span>$l$</span> are stored in <code>t[:,l]</code>.</li><li><code>V::Matrix{T}</code>: The diagonal on-site energy matrices <span>$V_l$</span> for imaginary-time slice <span>$l$</span> are stored in <code>V[:,l]</code>.</li><li><code>K::Matrix{T}</code>: Used to construct hopping matrix to cacluate exponentiated hopping matrix if checkerboard approximation is not being used.</li><li><code>eigen_ws::HermitianEigenWs{T,Matrix{T},E}</code>: For calculating eigenvalues and eigenvectors of <code>K</code> while avoiding dynamic memory allocations.</li><li><code>u::Vector{T}</code>: Temporary vector to avoid dynamic allocation when performing local updates.</li><li><code>v::Vector{T}</code>: Temporary vector to avoid dynamic allocation when performing local updates.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/FermionPathIntegral.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.FermionPathIntegral-Tuple{}" href="#SmoQyDQMC.FermionPathIntegral-Tuple{}"><code>SmoQyDQMC.FermionPathIntegral</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FermionPathIntegral(;
    tight_binding_parameters::TightBindingParameters{T,E},
    β::E, Δτ::E
) where {T,E}</code></pre><p>Initialize an instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> an instance of <a href="#SmoQyDQMC.TightBindingParameters"><code>TightBindingParameters</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/FermionPathIntegral.jl#L48-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_propagators" href="#SmoQyDQMC.initialize_propagators"><code>SmoQyDQMC.initialize_propagators</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_propagators(fpi::FermionPathIntegral{T,E}; symmetric::Bool, checkerboard::Bool) where {T,E}</code></pre><p>Initialize a propagator for each imaginary time slice, returning a vector of type <code>Vector{&lt;:AbstractPropagators{T,E}}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/FermionPathIntegral.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.calculate_propagators!" href="#SmoQyDQMC.calculate_propagators!"><code>SmoQyDQMC.calculate_propagators!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_propagators!(B::Vector{P}, fpi::FermionPathIntegral{T,E};
                       calculate_exp_V::Bool, calculate_exp_K::Bool) where {T, E, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Calculate the propagator matrices <span>$B_l$</span>, given by <code>B[l]</code>, for all imaginary time slice <span>$\tau = \Delta\tau \cdot l.$</span> If <code>calculate_exp_V = true</code>, then calculate the diagonal exponentiated on-site energy matrices. If <code>calculate_exp_K = true</code>, then calculate the exponentiated hopping matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/FermionPathIntegral.jl#L263-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.calculate_propagator!" href="#SmoQyDQMC.calculate_propagator!"><code>SmoQyDQMC.calculate_propagator!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_propagator!(B::AbstractPropagator{T,E}, fpi::FermionPathIntegral{T,E}, l::Int;
                      calculate_exp_V::Bool, calculate_exp_K::Bool) where {T,E}</code></pre><p>Calculate the propagator matrix <span>$B_l$</span> for imaginary time slice <span>$\tau = \Delta\tau \cdot l.$</span> If <code>calculate_exp_V = true</code>, then calculate the diagonal exponentiated on-site energy matrix. If <code>calculate_exp_K = true</code>, then calculate the exponentiated hopping matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/FermionPathIntegral.jl#L284-L291">source</a></section></article><h2 id="Update-Numerical-Stabilization-Frequency"><a class="docs-heading-anchor" href="#Update-Numerical-Stabilization-Frequency">Update Numerical Stabilization Frequency</a><a id="Update-Numerical-Stabilization-Frequency-1"></a><a class="docs-heading-anchor-permalink" href="#Update-Numerical-Stabilization-Frequency" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.update_stabalization_frequency!"><code>update_stabalization_frequency!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.update_stabalization_frequency!" href="#SmoQyDQMC.update_stabalization_frequency!"><code>SmoQyDQMC.update_stabalization_frequency!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_stabalization_frequency!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
                                Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T;
                                fermion_greens_calculator_up::FermionGreensCalculator{T,E},
                                fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
                                Bup::Vector{P}, Bdn::Vector{P}, δG::E, δθ::E, n_stab::Int,
                                δG_max::E) where {E&lt;:AbstractFloat, T&lt;:Number, P&lt;:AbstractPropagator{T,E}}</code></pre><p>If the corrected error in the Green&#39;s function matrix is too large, <code>δG &gt; δG_max</code>, then increase the frequency of numerical stablization by decrementing <code>n_stab</code> such that it is updated to <code>n_stab = max(n_stab - 1, 1)</code>, and update the equal-time Green&#39;s function matrices and all related variables and types. If the frequency of stabilization is udpated, then <code>δG</code> and <code>δθ</code> are reset to zero. This method returns a tuple of the following variables:</p><pre><code class="language-julia hljs">(logdetGup, sgndetGdn, logdetGup, sgndetGdn, δG, δθ),</code></pre><p>where <code>updated = true</code> if <code>n_stab</code> was decremented.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/update_stabilization_frequency.jl#L1-L18">source</a></section><section><div><pre><code class="language-julia hljs">update_stabalization_frequency!(G::Matrix{T}, logdetG::E, sgndetG::T;
                                fermion_greens_calculator::FermionGreensCalculator{T,E},
                                B::Vector{P}, δG::E, δθ::E, n_stab::Int,
                                δG_max::E) where {E&lt;:AbstractFloat, T&lt;:Number, P&lt;:AbstractPropagator{T,E}}</code></pre><p>If the corrected error in the Green&#39;s function matrix is too large, <code>δG &gt; δG_max</code>, then increase the frequency of numerical stablization by decrementing <code>n_stab</code> such that it is updated to <code>n_stab = max(n_stab - 1, 1)</code>, and update the equal-time Green&#39;s function matrices and all related variables and types. If the frequency of stabilization is udpated, then <code>δG</code> and <code>δθ</code> are reset to zero. This method returns a tuple of the following variables:</p><pre><code class="language-julia hljs">(updated, logdetG, sgndetG, δG, δθ),</code></pre><p>where <code>updated = true</code> if <code>n_stab</code> was decremented.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/update_stabilization_frequency.jl#L68-L83">source</a></section></article><h2 id="Tight-Binding-Model"><a class="docs-heading-anchor" href="#Tight-Binding-Model">Tight-Binding Model</a><a id="Tight-Binding-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Tight-Binding-Model" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.TightBindingModel"><code>TightBindingModel</code></a></li><li><a href="#SmoQyDQMC.TightBindingParameters"><code>TightBindingParameters</code></a></li><li><a href="#SmoQyDQMC.measure_onsite_energy"><code>measure_onsite_energy</code></a></li><li><a href="#SmoQyDQMC.measure_hopping_energy"><code>measure_hopping_energy</code></a></li><li><a href="#SmoQyDQMC.measure_bare_hopping_energy"><code>measure_bare_hopping_energy</code></a></li><li><a href="#SmoQyDQMC.measure_hopping_amplitude"><code>measure_hopping_amplitude</code></a></li><li><a href="#SmoQyDQMC.measure_hopping_inversion"><code>measure_hopping_inversion</code></a></li><li><a href="#SmoQyDQMC.measure_hopping_inversion_avg"><code>measure_hopping_inversion_avg</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.TightBindingModel" href="#SmoQyDQMC.TightBindingModel"><code>SmoQyDQMC.TightBindingModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingModel{T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Defines a tight binding model in <code>D</code> dimensions. Note that <code>spin = 1 (spin = 2)</code> corresponds to spin-up (spin-down), and <code>spin = 0</code> corresponds to both spin-up and spin-down.</p><p><strong>Fields</strong></p><ul><li><code>μ::E</code>: Chemical potential.</li><li><code>ϵ_mean::Vector{E}</code>: Mean on-site energy for each orbital in the unit cell. </li><li><code>ϵ_std::Vector{E}</code>: Standard deviation of on-site energy for each orbital in the unit cell.</li><li><code>t_bond_ids::Vector{Int}</code>: The bond ID for each bond/hopping definition.</li><li><code>t_bonds::Vector{Bond{D}}</code>: Bond definition for each type of hopping in the tight binding model.</li><li><code>t_mean::Vector{T}</code>: Mean hopping energy for each type of hopping.</li><li><code>t_std::Vector{E}</code>: Standard deviation of hopping energy for each type of hopping.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/TightBinding.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.TightBindingModel-Tuple{}" href="#SmoQyDQMC.TightBindingModel-Tuple{}"><code>SmoQyDQMC.TightBindingModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingModel(;
    model_geometry::ModelGeometry{D,E,N},
    μ::E,
    ϵ_mean::Vector{E},
    ϵ_std::Vector{E} = zeros(eltype(ϵ_mean), length(ϵ_mean)),
    t_bonds::Vector{Bond{D}} = Bond{ndims(model_geometry.unit_cell)}[],
    t_mean::Vector{T} = eltype(ϵ_mean)[],
    t_std::Vector{E} = zeros(eltype(ϵ_mean), length(t_mean))
) where {T&lt;:Number, E&lt;:AbstractFloat, D, N}</code></pre><p>Initialize and return an instance of <a href="#SmoQyDQMC.TightBindingModel"><code>TightBindingModel</code></a>, also adding/recording the bond defintions <code>t_bonds</code> to the <a href="#SmoQyDQMC.ModelGeometry"><code>ModelGeometry</code></a> instance <code>model_geometry</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/TightBinding.jl#L41-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.TightBindingParameters" href="#SmoQyDQMC.TightBindingParameters"><code>SmoQyDQMC.TightBindingParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingParameters{T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>A mutable struct containing all the parameters needed to characterize a finite tight-binding Hamiltonian for a single spin species <span>$\sigma$</span> on a finite lattice with periodic boundary conditions of the form</p><p class="math-container">\[\hat{H}_{0,\sigma}=-\sum_{\langle i,j\rangle}(t_{ij} \hat{c}_{\sigma,i}^{\dagger}\hat{c}_{\sigma,j}+\textrm{h.c.})+\sum_{i}(\epsilon_{i}-\mu)\hat{n}_{\sigma,i},\]</p><p>where <span>$\hat{c}_{\sigma,i}^\dagger$</span> is the fermion creation operator for an electron with spin <span>$\sigma$</span> on orbital <span>$i,$</span> <span>$t_{i,j}$</span> are the hopping energies, <span>$\epsilon_i$</span> are the on-site energies for each orbital in the lattice, and <span>$\mu$</span> is the chemical potential.</p><p><strong>Fields</strong></p><ul><li><code>μ::E</code>: The chemical potential <span>$\mu.$</span></li><li><code>const ϵ::Vector{E}</code>: A vector containing the on-site energy <span>$\epsilon_i$</span> for each orbital in the lattice.</li><li><code>const t::Vector{T}</code>: The hopping energy <span>$t_{i,j}$</span> associated with each pair of neighboring orbitals connected by a bond in the lattice.</li><li><code>const neighbor_table::Matrix{Int}</code>: Neighbor table containing all pairs of orbitals in the lattices connected by a bond, with a non-zero hopping energy between them.</li><li><code>const bond_ids::Vector{Int}</code>: The bond ID definitions that define the types of hopping in the lattice.</li><li><code>const bond_slices::Vector{UnitRange{Int}}</code>: Slices of <code>neighbor_table</code> corresponding to given bond ID i.e. the neighbors <code>neighbor_table[:,bond_slices[1]]</code> corresponds the <code>bond_ids[1]</code> bond defintion.</li><li><code>const norbital::Int</code>: Number of orbitals per unit cell.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/TightBinding.jl#L162-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.TightBindingParameters-Tuple{}" href="#SmoQyDQMC.TightBindingParameters-Tuple{}"><code>SmoQyDQMC.TightBindingParameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingParameters(;
    tight_binding_model::TightBindingModel{T,E,D},
    model_geometry::ModelGeometry{D,E},
    rng::AbstractRNG
) where {T,E,D}</code></pre><p>Initialize and return an instance of <a href="#SmoQyDQMC.TightBindingParameters"><code>TightBindingParameters</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/TightBinding.jl#L209-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_onsite_energy" href="#SmoQyDQMC.measure_onsite_energy"><code>SmoQyDQMC.measure_onsite_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_onsite_energy(
    tight_binding_parameters::TightBindingParameters{T,E},
    G::Matrix{T}, orbital_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Measure and return the on-site energy <span>$\epsilon_\textrm{on-site} = (\epsilon - \mu)\langle \hat{n}_\sigma \rangle$</span> for the <code>orbital_id</code> in the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_hopping_energy" href="#SmoQyDQMC.measure_hopping_energy"><code>SmoQyDQMC.measure_hopping_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_hopping_energy(
    tight_binding_parameters::TightBindingParameters{T,E},
    fermion_path_integral::FermionPathIntegral{T,E},
    G::Matrix{T}, bond_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the average hopping energy <span>$\epsilon_{\rm hopping} = -\langle t_{l,\langle i,j \rangle} \hat{c}^\dagger_{\sigma,i} \hat{c}_{\sigma,j} + {\rm h.c.} \rangle$</span> for the hopping defined by the bond corresponding to <code>bond_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L89-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_bare_hopping_energy" href="#SmoQyDQMC.measure_bare_hopping_energy"><code>SmoQyDQMC.measure_bare_hopping_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_bare_hopping_energy(
    tight_binding_parameters::TightBindingParameters{T,E},
    G::Matrix{T}, bond_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the average bare hopping energy <span>$\epsilon_{\rm hopping} = -\langle t_{\langle i,j \rangle} \hat{c}^\dagger_{\sigma,i} \hat{c}_{\sigma,j} + {\rm h.c.} \rangle$</span> for the hopping defined by the bond corresponding to <code>bond_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L40-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_hopping_amplitude" href="#SmoQyDQMC.measure_hopping_amplitude"><code>SmoQyDQMC.measure_hopping_amplitude</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_hopping_amplitude(
    tight_binding_parameters::TightBindingParameters{T,E},
    fermion_path_integral::FermionPathIntegral{T,E},
    bond_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the average hopping amplitude for the hopping defined by the bond corresponding to <code>bond_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L141-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_hopping_inversion" href="#SmoQyDQMC.measure_hopping_inversion"><code>SmoQyDQMC.measure_hopping_inversion</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_hopping_inversion(
    tight_binding_parameters::TightBindingParameters{T,E},
    fermion_path_integral::FermionPathIntegral{T,E},
    bond_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Measure the fraction of time the sign of the instaneous modulated hopping ampltiude <span>$t_{l,(\mathbf{i},\nu),(\mathbf{j},\gamma)}$</span> is inverted relative to the bare hopping amplitude <span>$t_{(\mathbf{i},\nu),(\mathbf{j},\gamma)}$</span>, where <span>$l$</span> is the imaginary time-slice index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L178-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_hopping_inversion_avg" href="#SmoQyDQMC.measure_hopping_inversion_avg"><code>SmoQyDQMC.measure_hopping_inversion_avg</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_hopping_inversion_avg(
    tight_binding_parameters::TightBindingParameters{T,E},
    fermion_path_integral::FermionPathIntegral{T,E},
    bond_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Measure the fraction of time the sign of the imaginary-time averaged modulated hopping ampltiude <span>$\bar{t}_{(\mathbf{i},\nu),(\mathbf{j},\gamma)}$</span> is inverted relative to the bare hopping amplitude <span>$t_{(\mathbf{i},\nu),(\mathbf{j},\gamma)}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/tight_binding_measurements.jl#L235-L245">source</a></section></article><h2 id="Hubbard-Model"><a class="docs-heading-anchor" href="#Hubbard-Model">Hubbard Model</a><a id="Hubbard-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Hubbard-Model" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.HubbardModel"><code>HubbardModel</code></a></li><li><a href="#SmoQyDQMC.HubbardParameters"><code>HubbardParameters</code></a></li><li><a href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardParameters{E}}} where {T, E}"><code>initialize!</code></a></li></ul><p><strong>Hubbard Model Measurements</strong></p><ul><li><a href="#SmoQyDQMC.measure_hubbard_energy"><code>measure_hubbard_energy</code></a></li></ul><p><strong>Hubbard Ising Hubbard-Stratonovich Transformation Types and Methods</strong></p><ul><li><a href="#SmoQyDQMC.HubbardIsingHSParameters"><code>HubbardIsingHSParameters</code></a></li><li><a href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardParameters{E}}} where {T, E}"><code>initialize!</code></a></li><li><a href="#SmoQyDQMC.local_updates!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>local_updates!</code></a></li><li><a href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>reflection_update!</code></a></li><li><a href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>swap_update!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardModel" href="#SmoQyDQMC.HubbardModel"><code>SmoQyDQMC.HubbardModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardModel{T&lt;:AbstractFloat}</code></pre><p>If <code>shifted = true</code>, then a Hubbard interaction of the form</p><p class="math-container">\[\hat{H}_{U}=\sum_{\mathbf{i},\nu}U_{\nu,\mathbf{i}}\hat{n}_{\uparrow,\nu,\mathbf{i}}\hat{n}_{\downarrow,\nu,\mathbf{i}}\]</p><p>is assumed, where <span>$\mathbf{i}$</span> specifies the unit cell, and <span>$\nu$</span> denotes the orbital in the unit cell. For a bipartite lattice with only nearest neighbor hopping, the on-site energy corresponding to half-filling and particle-hole symmetry is <span>$\epsilon_{\nu,\mathbf{i}} = -U_{\nu,\mathbf{i}}/2.$</span></p><p>If <code>shifted = false</code>, then a Hubbard interaction of the form</p><p class="math-container">\[\hat{H}_{U}=\sum_{\mathbf{i},\nu}U_{\nu,\mathbf{i}}(\hat{n}_{\uparrow,\nu,\mathbf{i}}-\tfrac{1}{2})(\hat{n}_{\downarrow,\nu,\mathbf{i}}-\tfrac{1}{2})\]</p><p>is assumed. In this case, for a bipartite lattice with only nearest neighbor hopping, the on-site energy corresponding to half-filling and particle-hole symmetry is <span>$\epsilon_{\nu,\mathbf{i}} = 0.$</span></p><p><strong>Fields</strong></p><ul><li><code>shifted::Bool</code>: Determines which form for Hubbard interaction is used, and whether the on-site energies need to be shifted.</li><li><code>U_orbital::Vector{Int}</code>: Orbital species in unit cell with finite Hubbard interaction.</li><li><code>U_mean::Vector{T}</code>: Average Hubbard <span>$U_\nu$</span> for a given orbital species in the lattice.</li><li><code>U_std::Vector{T}</code>: Standard deviation of Hubbard <span>$U_\nu$</span> for a given orbital species in the lattice.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardModel.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardModel-Tuple{}" href="#SmoQyDQMC.HubbardModel-Tuple{}"><code>SmoQyDQMC.HubbardModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardModel(;
    shifted::Bool,
    U_orbital::AbstractVector{Int},
    U_mean::AbstractVector{T},
    U_std::AbstractVector{T} = zero(U_mean)
) where {T&lt;:AbstractFloat}</code></pre><p>Initialize and return an instance of the type <a href="#SmoQyDQMC.HubbardModel"><code>HubbardModel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardModel.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardParameters" href="#SmoQyDQMC.HubbardParameters"><code>SmoQyDQMC.HubbardParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardParameters{T&lt;:AbstractFloat}</code></pre><p>Hubbard parameters for finite lattice.</p><p><strong>Fields</strong></p><ul><li><code>U::Vector{T}</code>: On-site Hubbard interaction for each site with finite Hubbard interaction.</li><li><code>sites::Vector{Int}</code>: Site index associated with each finite Hubbard <code>U</code> interaction.</li><li><code>orbitals::Vector{Int}</code>: Orbital species in unit cell with finite Hubbard interaction.</li><li><code>shifted::Bool</code>: Convention used for Hubbard interaction, refer to <a href="#SmoQyDQMC.HubbardModel"><code>HubbardModel</code></a> for more information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardModel.jl#L77-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardParameters-Tuple{}" href="#SmoQyDQMC.HubbardParameters-Tuple{}"><code>SmoQyDQMC.HubbardParameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardParameters(;
    hubbard_model::HubbardModel{T},
    model_geometry::ModelGeometry{D,T},
    rng::AbstractRNG
) where {D, T&lt;:AbstractFloat}</code></pre><p>Initialize an instance of <a href="#SmoQyDQMC.HubbardParameters"><code>HubbardParameters</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardModel.jl#L104-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardParameters{E}}} where {T, E}" href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardParameters{E}}} where {T, E}"><code>SmoQyDQMC.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    hubbard_parameters::HubbardParameters{E}
) where {T,E}

initialize!(
    fermion_path_integral::FermionPathIntegral{T,E},
    hubbard_parameters::HubbardParameters{E}
) where {T,E}</code></pre><p>Initialize the contribution from the Hubbard interaction to a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardModel.jl#L154-L167">source</a></section></article><h3 id="Hubbard-Model-Measurements"><a class="docs-heading-anchor" href="#Hubbard-Model-Measurements">Hubbard Model Measurements</a><a id="Hubbard-Model-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Hubbard-Model-Measurements" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_hubbard_energy" href="#SmoQyDQMC.measure_hubbard_energy"><code>SmoQyDQMC.measure_hubbard_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_hubbard_energy(
    hubbard_parameters::HubbardParameters{E},
    Gup::Matrix{T}, Gdn::Matrix{T},
    orbital_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the average Hubbard energy <span>$U \langle \hat{n}_\uparrow \hat{n}_\downarrow \rangle$</span> if <code>shifted = true</code> and <span>$U \langle (\hat{n}_\uparrow - \tfrac{1}{2})(\hat{n}_\downarrow - \tfrac{1}{2})\rangle$</span> if <code>shifted = false</code> for the orbital corresponding <code>orbital_id</code> in the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/hubbard_model_measurements.jl#L1-L11">source</a></section></article><h3 id="Hubbard-Ising-Hubbard-Stratonovich-Transformation-Types-and-Methods"><a class="docs-heading-anchor" href="#Hubbard-Ising-Hubbard-Stratonovich-Transformation-Types-and-Methods">Hubbard Ising Hubbard-Stratonovich Transformation Types and Methods</a><a id="Hubbard-Ising-Hubbard-Stratonovich-Transformation-Types-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Hubbard-Ising-Hubbard-Stratonovich-Transformation-Types-and-Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardIsingHSParameters" href="#SmoQyDQMC.HubbardIsingHSParameters"><code>SmoQyDQMC.HubbardIsingHSParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardIsingHSParameters{T&lt;:AbstractFloat}</code></pre><p>Parameters associated with decoupling the Hubbard interaction using the standard Ising Hubbard-Stratonovich (HS) transformation.</p><p><strong>Fields</strong></p><ul><li><code>β::T</code>: Inverse temperature.</li><li><code>Δτ::T</code>: Discretization in imaginary time.</li><li><code>Lτ::Int</code>: Length of imaginary time axis.</li><li><code>N::Int</code>: Number of orbitals in the lattice.</li><li><code>U::Vector{T}</code>: Each hubbard interaction.</li><li><code>α::Vector{T}</code>: The constant given by <span>$\cosh(\alpha_i) = e^{\Delta\tau \vert U_i \vert/2}.$</span></li><li><code>sites::Vector{Int}</code>: Site index associated with each finite Hubbard <code>U</code> interaction.</li><li><code>s::Matrix{Int}</code>: Ising Hubbard-Stratonovich fields.</li><li><code>update_perm::Vector{Int}</code>: Order in which to iterate over HS fields in time slice when performing local updates.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HubbardIsingHSParameters-Tuple{}" href="#SmoQyDQMC.HubbardIsingHSParameters-Tuple{}"><code>SmoQyDQMC.HubbardIsingHSParameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HubbardIsingHSParameters(; β::E, Δτ::E,
                         hubbard_parameters::HubbardParameters{E},
                         rng::AbstractRNG) where {E&lt;:AbstractFloat}</code></pre><p>Initialize and return an instance of the <a href="#SmoQyDQMC.HubbardIsingHSParameters"><code>HubbardIsingHSParameters</code></a> type. Note that on-site energies <code>fpi.V</code> are shifted by <span>$-U_i/2$</span> if <span>$hm.shifted = true$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L50-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardIsingHSParameters{E}}} where {T, E}" href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardIsingHSParameters{E}}} where {T, E}"><code>SmoQyDQMC.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(fermion_path_integral_up::FermionPathIntegral{T,E},
            fermion_path_integral_dn::FermionPathIntegral{T,E},
            hubbard_ising_parameters::HubbardIsingHSParameters{E}) where {T,E}</code></pre><p>Initialize the contribution from the Hubbard interaction to the <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> instance <code>fermion_path_integral_up</code> for spin up and <code>fermion_path_integral_dn</code> spin down.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L84-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, HubbardIsingHSParameters{E}}} where {T, E}" href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, HubbardIsingHSParameters{E}}} where {T, E}"><code>SmoQyDQMC.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(fermion_path_integral::FermionPathIntegral{T,E},
            hubbard_ising_parameters::HubbardIsingHSParameters{E}) where {T,E}</code></pre><p>Initialize the contribution from an attractive Hubbard interaction to the <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> instance <code>fermion_path_integral</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L113-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.local_updates!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.local_updates!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.local_updates!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">local_updates!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
               Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
               hubbard_ising_parameters::HubbardIsingHSParameters{E};
               fermion_path_integral_up::FermionPathIntegral{T,E},
               fermion_path_integral_dn::FermionPathIntegral{T,E},
               fermion_greens_calculator_up::FermionGreensCalculator{T,E},
               fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
               Bup::Vector{P}, Bdn::Vector{P},
               δG_max::E, δG::E, δθ::E,  rng::AbstractRNG,
               update_stabilization_frequency::Bool=true) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Sweep through every imaginary time slice and orbital in the lattice, peforming local updates to every Ising Hubbard-Stratonovich (HS) field.</p><p>This method returns the a tuple containing <code>(acceptance_rate, logdetGup, sgndetGup, logdetGdn, sgndetGdn, δG, δθ)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Gup::Matrix{T}</code>: Spin-up equal-time Green&#39;s function matrix.</li><li><code>logdetGup::E</code>: The log of the absolute value of the determinant of the spin-up equal-time Green&#39;s function matrix, <span>$\log \vert \det G_\uparrow(\tau,\tau) \vert.$</span></li><li><code>sgndetGup::T</code>: The sign/phase of the determinant of the spin-up equal-time Green&#39;s function matrix, <span>$\det G_\uparrow(\tau,\tau) / \vert \det G_\uparrow(\tau,\tau) \vert.$</span></li><li><code>Gdn::Matrix{T}</code>: Spin-down equal-time Green&#39;s function matrix.</li><li><code>logdetGdn::E</code>: The log of the absolute value of the determinant of the spin-down equal-time Green&#39;s function matrix, <span>$\log \vert \det G_\downarrow(\tau,\tau) \vert.$</span></li><li><code>sgndetGdn::T</code>: The sign/phase of the determinant of the spin-down equal-time Green&#39;s function matrix, <span>$\det G_\downarrow(\tau,\tau) / \vert \det G_\downarrow(\tau,\tau) \vert.$</span></li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral_up::FermionPathIntegral{T,E}</code>: An instance of the <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-up electrons.</li><li><code>fermion_path_integral_dn::FermionPathIntegral{T,E}</code>: An instance of the <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-down electrons.</li><li><code>fermion_greens_calculator_up::FermionGreensCalculator{T,E}</code>: An instance of the <a href="https://smoqysuite.github.io/JDQMCFramework.jl/stable/api/#JDQMCFramework.FermionGreensCalculator"><code>FermionGreensCalculator</code></a> type for the spin-up electrons.</li><li><code>fermion_greens_calculator_dn::FermionGreensCalculator{T,E}</code>: An instance of the <a href="https://smoqysuite.github.io/JDQMCFramework.jl/stable/api/#JDQMCFramework.FermionGreensCalculator"><code>FermionGreensCalculator</code></a> type for the spin-down electrons.</li><li><code>Bup::Vector{P}</code>: Spin-up propagators for each imaginary time slice.</li><li><code>Bdn::Vector{P}</code>: Spin-dn propagators for each imaginary time slice.</li><li><code>δG_max::E</code>: Maximum allowed error corrected by numerical stabilization.</li><li><code>δG::E</code>: Previously recorded maximum error in the Green&#39;s function corrected by numerical stabilization.</li><li><code>δθ::T</code>: Previously recorded maximum error in the sign/phase of the determinant of the equal-time Green&#39;s function matrix corrected by numerical stabilization.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>update_stabilization_frequency::Bool=true</code>: If true, allows the stabilization frequency <code>n_stab</code> to be dynamically adjusted.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L141-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.local_updates!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.local_updates!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.local_updates!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">local_updates!(G::Matrix{T}, logdetG::E, sgndetG::T,
               hubbard_ising_parameters::HubbardIsingHSParameters{E};
               fermion_path_integral::FermionPathIntegral{T,E},
               fermion_greens_calculator::FermionGreensCalculator{T,E},
               B::Vector{P}, δG_max::E, δG::E, δθ::E, rng::AbstractRNG,
               update_stabilization_frequency::Bool=true) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Sweep through every imaginary time slice and orbital in the lattice, performing local updates to every Ising Hubbard-Stratonovich (HS) field, assuming strictly attractive Hubbard interactions and perfect spin symmetry.</p><p>This method returns the a tuple containing <code>(acceptance_rate, logdetG, sgndetG, δG, δθ)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>G::Matrix{T}</code>: Equal-time Green&#39;s function matrix.</li><li><code>logdetG::E</code>: The log of the absolute value of the determinant of theequal-time Green&#39;s function matrix, <span>$\log \vert \det G_\uparrow(\tau,\tau) \vert.$</span></li><li><code>sgndetG::T</code>: The sign/phase of the determinant of the equal-time Green&#39;s function matrix, <span>$\det G_\uparrow(\tau,\tau) / \vert \det G_\uparrow(\tau,\tau) \vert.$</span></li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral::FermionPathIntegral{T,E}</code>: An instance of the <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type.</li><li><code>fermion_greens_calculator::FermionGreensCalculator{T,E}</code>: An instance of the <a href="https://smoqysuite.github.io/JDQMCFramework.jl/stable/api/#JDQMCFramework.FermionGreensCalculator"><code>FermionGreensCalculator</code></a> type.</li><li><code>B::Vector{P}</code>: Propagators for each imaginary time slice.</li><li><code>δG_max::E</code>: Maximum allowed error corrected by numerical stabilization.</li><li><code>δG::E</code>: Previously recorded maximum error in the Green&#39;s function corrected by numerical stabilization.</li><li><code>δθ::T</code>: Previously recorded maximum error in the sign/phase of the determinant of the equal-time Green&#39;s function matrix corrected by numerical stabilization.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>update_stabilization_frequency::Bool=true</code>:  If true, allows the stabilization frequency <code>n_stab</code> to be dynamically adjusted.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L319-L349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.reflection_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflection_update!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
                   Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
                   hubbard_ising_parameters::HubbardIsingHSParameters{E};
                   fermion_path_integral_up::FermionPathIntegral{T,E},
                   fermion_path_integral_dn::FermionPathIntegral{T,E},
                   fermion_greens_calculator_up::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
                   Bup::Vector{P}, Bdn::Vector{P},
                   rng::AbstractRNG) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform a reflection update where the sign of every Ising Hubbard-Stratonovich field on a randomly chosen orbital in the lattice is changed. This function returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Gup::Matrix{T}</code>: Spin-up eqaul-time Greens function matrix.</li><li><code>logdetGup::E</code>: Log of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>sgndetGup::T</code>: Sign/phase of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>Gdn::Matrix{T}</code>: Spin-down eqaul-time Greens function matrix.</li><li><code>logdetGdn::E</code>: Log of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>sgndetGdn::T</code>: Sign/phase of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral_up::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-up electrons.</li><li><code>fermion_path_integral_dn::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-down electrons.</li><li><code>fermion_greens_calculator_up::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-up sector state.</li><li><code>fermion_greens_calculator_dn::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-down sector state.</li><li><code>fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>Bup::Vector{P}</code>: Spin-up propagators for each imaginary time slice.</li><li><code>Bdn::Vector{P}</code>: Spin-down propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L453-L490">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.reflection_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflection_update!(G::Matrix{T}, logdetG::E, sgndetG::T,
                   hubbard_ising_parameters::HubbardIsingHSParameters{E};
                   fermion_path_integral::FermionPathIntegral{T,E},
                   fermion_greens_calculator::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
                   B::Vector{P},
                   rng::AbstractRNG) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform a reflection update where the sign of every Ising Hubbard-Stratonovich field on a randomly chosen orbital in the lattice is changed. This function returns <code>(accepted, logdetG, sgndetG)</code>. This method assumes strictly attractive Hubbard interactions.</p><p><strong>Arguments</strong></p><ul><li><code>G::Matrix{T}</code>: Eqaul-time Greens function matrix.</li><li><code>logdetG::E</code>: Log of the determinant of the eqaul-time Greens function matrix.</li><li><code>sgndetG::T</code>: Sign/phase of the determinant of the eqaul-time Greens function matrix.</li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type.</li><li><code>fermion_greens_calculator::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current state.</li><li><code>fermion_greens_calculator_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed state.</li><li><code>B::Vector{P}</code>: Propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L584-L610">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.swap_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">swap_update!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
             Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
             hubbard_ising_parameters::HubbardIsingHSParameters{E};
             fermion_path_integral_up::FermionPathIntegral{T,E},
             fermion_path_integral_dn::FermionPathIntegral{T,E},
             fermion_greens_calculator_up::FermionGreensCalculator{T,E},
             fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
             fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
             fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
             Bup::Vector{P}, Bdn::Vector{P},
             rng::AbstractRNG) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform a swap update where the HS fields associated with two randomly chosen sites in the lattice are exchanged. This function returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Gup::Matrix{T}</code>: Spin-up eqaul-time Greens function matrix.</li><li><code>logdetGup::E</code>: Log of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>sgndetGup::T</code>: Sign/phase of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>Gdn::Matrix{T}</code>: Spin-down eqaul-time Greens function matrix.</li><li><code>logdetGdn::E</code>: Log of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>sgndetGdn::T</code>: Sign/phase of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral_up::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-up electrons.</li><li><code>fermion_path_integral_dn::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-down electrons.</li><li><code>fermion_greens_calculator_up::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-up sector state.</li><li><code>fermion_greens_calculator_dn::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-down sector state.</li><li><code>fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>Bup::Vector{P}</code>: Spin-up propagators for each imaginary time slice.</li><li><code>Bdn::Vector{P}</code>: Spin-down propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L683-L720">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.swap_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">swap_update!(G::Matrix{T}, logdetG::E, sgndetG::T,
             hubbard_ising_parameters::HubbardIsingHSParameters{E};
             fermion_path_integral::FermionPathIntegral{T,E},
             fermion_greens_calculator::FermionGreensCalculator{T,E},
             fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
             B::Vector{P}, rng::AbstractRNG) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>For strictly attractive Hubbard interactions, perform a swap update where the HS fields associated with two randomly chosen sites in the lattice are exchanged. This function returns <code>(accepted, logdetG, sgndetG)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>G::Matrix{T}</code>: Eqaul-time Greens function matrix.</li><li><code>logdetG::E</code>: Log of the determinant of the eqaul-time Greens function matrix.</li><li><code>sgndetG::T</code>: Sign/phase of the determinant of the eqaul-time Greens function matrix.</li><li><code>hubbard_ising_parameters::HubbardIsingHSParameters{E}</code>: Ising Hubbard-Stratonovich fields and associated parameters to update.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type.</li><li><code>fermion_greens_calculator::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current state.</li><li><code>fermion_greens_calculator_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed state.</li><li><code>B::Vector{P}</code>: Propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Hubbard/HubbardIsingHS.jl#L843-L868">source</a></section></article><h2 id="Electron-Phonon-Model"><a class="docs-heading-anchor" href="#Electron-Phonon-Model">Electron-Phonon Model</a><a id="Electron-Phonon-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Model" title="Permalink"></a></h2><p><strong>Electron-Phonon Model Types and Method</strong></p><ul><li><a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a></li><li><a href="#SmoQyDQMC.PhononMode"><code>PhononMode</code></a></li><li><a href="#SmoQyDQMC.HolsteinCoupling"><code>HolsteinCoupling</code></a></li><li><a href="#SmoQyDQMC.SSHCoupling"><code>SSHCoupling</code></a></li><li><a href="#SmoQyDQMC.PhononDispersion"><code>PhononDispersion</code></a></li><li><a href="#SmoQyDQMC.add_phonon_mode!"><code>add_phonon_mode!</code></a></li><li><a href="#SmoQyDQMC.add_holstein_coupling!"><code>add_holstein_coupling!</code></a></li><li><a href="#SmoQyDQMC.add_ssh_coupling!"><code>add_ssh_coupling!</code></a></li><li><a href="#SmoQyDQMC.add_phonon_dispersion!"><code>add_phonon_dispersion!</code></a></li></ul><p><strong>Electron-Phonon Parameter Types and Methods</strong></p><ul><li><a href="#SmoQyDQMC.ElectronPhononParameters"><code>ElectronPhononParameters</code></a></li><li><a href="#SmoQyDQMC.PhononParameters"><code>SmoQyDQMC.PhononParameters</code></a></li><li><a href="#SmoQyDQMC.HolsteinParameters"><code>SmoQyDQMC.HolsteinParameters</code></a></li><li><a href="#SmoQyDQMC.SSHParameters"><code>SmoQyDQMC.SSHParameters</code></a></li><li><a href="#SmoQyDQMC.DispersionParameters"><code>SmoQyDQMC.DispersionParameters</code></a></li><li><a href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, HubbardParameters{E}}} where {T, E}"><code>initialize!</code></a></li><li><a href="#SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Matrix{E}}} where {T, E}"><code>update!</code></a></li></ul><p><strong>Electron-Phonon Measurements</strong></p><ul><li><a href="#SmoQyDQMC.measure_phonon_kinetic_energy"><code>measure_phonon_kinetic_energy</code></a></li><li><a href="#SmoQyDQMC.measure_phonon_potential_energy"><code>measure_phonon_potential_energy</code></a></li><li><a href="#SmoQyDQMC.measure_phonon_position_moment"><code>measure_phonon_position_moment</code></a></li><li><a href="#SmoQyDQMC.measure_holstein_energy"><code>measure_holstein_energy</code></a></li><li><a href="#SmoQyDQMC.measure_ssh_energy"><code>measure_ssh_energy</code></a></li><li><a href="#SmoQyDQMC.measure_ssh_sgn_switch"><code>measure_ssh_sgn_switch</code></a></li><li><a href="#SmoQyDQMC.measure_dispersion_energy"><code>measure_dispersion_energy</code></a></li></ul><p><strong>Electron-Phonon Updates</strong></p><ul><li><a href="#SmoQyDQMC.HMCUpdater"><code>HMCUpdater</code></a></li><li><a href="#SmoQyDQMC.EFAHMCUpdater"><code>EFAHMCUpdater</code></a></li><li><a href="#SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}, HMCUpdater{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>hmc_update!</code></a></li><li><a href="#SmoQyDQMC.FourierMassMatrix"><code>SmoQyDQMC.FourierMassMatrix</code></a></li><li><a href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>reflection_update!</code></a></li><li><a href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, HubbardIsingHSParameters{E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>swap_update!</code></a></li></ul><h3 id="Electron-Phonon-Model-Types-and-Method"><a class="docs-heading-anchor" href="#Electron-Phonon-Model-Types-and-Method">Electron-Phonon Model Types and Method</a><a id="Electron-Phonon-Model-Types-and-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Model-Types-and-Method" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ElectronPhononModel" href="#SmoQyDQMC.ElectronPhononModel"><code>SmoQyDQMC.ElectronPhononModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElectronPhononModel{T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Defines an electron-phonon model.</p><p><strong>Fields</strong></p><ul><li><code>phonon_modes::Vector{PhononModes{E}}</code>: A vector of <a href="#SmoQyDQMC.PhononMode"><code>PhononMode</code></a> definitions.</li><li><code>phonon_dispersions::Vector{PhononDispersion{E,D}}</code>: A vector of <a href="#SmoQyDQMC.PhononDispersion"><code>PhononDispersion</code></a> defintions.</li><li><code>holstein_couplings_up::Vector{HolsteinCoupling{E,D}}</code>: A vector of <a href="#SmoQyDQMC.HolsteinCoupling"><code>HolsteinCoupling</code></a> definitions for spin-up.</li><li><code>holstein_couplings_dn::Vector{HolsteinCoupling{E,D}}</code>: A vector of <a href="#SmoQyDQMC.HolsteinCoupling"><code>HolsteinCoupling</code></a> definitions for spin-down.</li><li><code>ssh_couplings_up::Vector{SSHCoupling{T,E,D}}</code>: A vector of <a href="#SmoQyDQMC.SSHCoupling"><code>SSHCoupling</code></a> defintions for spin-up.</li><li><code>ssh_couplings_dn::Vector{SSHCoupling{T,E,D}}</code>: A vector of <a href="#SmoQyDQMC.SSHCoupling"><code>SSHCoupling</code></a> defintions for spin-down.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L372-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ElectronPhononModel-Tuple{}" href="#SmoQyDQMC.ElectronPhononModel-Tuple{}"><code>SmoQyDQMC.ElectronPhononModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElectronPhononModel(;
    model_geometry::ModelGeometry{D,E},
    tight_binding_model::Union{TightBindingModel{T,E,D}, Nothing} = nothing,
    tight_binding_model_up::Union{TightBindingModel{T,E,D}, Nothing} = nothing,
    tight_binding_model_dn::Union{TightBindingModel{T,E,D}, Nothing} = nothing
) where {T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Initialize and return a null (empty) instance of <a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a>. Note that either <code>tight_binding_model</code> or <code>tight_binding_model_up</code> and <code>tight_binding_model_dn</code> needs to be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L407-L418">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.PhononMode" href="#SmoQyDQMC.PhononMode"><code>SmoQyDQMC.PhononMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhononMode{E&lt;:AbstractFloat}</code></pre><p>Defines a phonon mode on the orbital species <code>orbital</code> in the unit cell. Specifically, it defines the phonon Hamiltonian terms</p><p class="math-container">\[\hat{H}_{{\rm ph}} = \sum_{\mathbf{i}}
  \left[
      \frac{1}{2} M_{\mathbf{i},\nu}\Omega_{\mathbf{i},\nu}^{2}\hat{X}_{\mathbf{i},\nu}^{2}
    + \frac{1}{12}M_{\mathbf{i},\nu}\Omega_{4,\mathbf{i},\nu}^{2}\hat{X}_{\mathbf{i},\nu}^{4}
    + \frac{1}{2M_{\mathbf{i},\nu}}\hat{P}_{\mathbf{i},\nu}^{2}
  \right],\]</p><p>where the sum runs over unit cell <span>$\mathbf{i}$</span>, <span>$\nu$</span> denotes the orbital species <code>orbital</code> in the unit cell, <span>$M_{\mathbf{i},\nu}$</span> is the phonon mass <code>M</code>, <span>$\Omega_{\mathbf{i},\nu}$</span> is the phonon frequency that is distributed according to a normal distribution with mean <code>Ω_mean</code> and standard deviation <code>Ω_std</code>. Lastly, <span>$\Omega_{4,\mathbf{i},\nu}$</span> is the anhmaronic coefficient, and is distributed according to a normal distribution with mean <code>Ω4_mean</code> and standard deviation <code>Ω4_std</code>.</p><p><strong>Fields</strong></p><ul><li><code>orbital::Int</code>: Orbital species <span>$\nu$</span> in the unit cell.</li><li><code>M::E</code>:: The phonon mass <span>$M_{\mathbf{i},\nu}.$</span></li><li><code>Ω_mean::E</code>: Mean of normal distribution the phonon frequency <span>$\Omega_{\mathbf{i},\nu}$</span> is sampled from.</li><li><code>Ω_std::E</code>: Standard deviation of normal distribution the phonon frequency <span>$\Omega_{\mathbf{i},\nu}$</span> is sampled from.</li><li><code>Ω4_mean::E</code>: Mean of normal distribution the anharmonic coefficient <span>$\Omega_{4,\mathbf{i},\nu}$</span> is sampled from.</li><li><code>Ω4_std::E</code>: Standard deviation of normal distribution the anharmonic coefficient <span>$\Omega_{4,\mathbf{i},\nu}$</span> is sampled from.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.PhononMode-Tuple{}" href="#SmoQyDQMC.PhononMode-Tuple{}"><code>SmoQyDQMC.PhononMode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhononMode(;
    orbital::Int, Ω_mean::E, Ω_std::E = 0.,
    M::E = 1., Ω4_mean::E = 0.0, Ω4_std::E = 0.0
) where {E&lt;:AbstractFloat}</code></pre><p>Initialize and return a instance of <a href="#SmoQyDQMC.PhononMode"><code>PhononMode</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L48-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HolsteinCoupling" href="#SmoQyDQMC.HolsteinCoupling"><code>SmoQyDQMC.HolsteinCoupling</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HolsteinCoupling{E&lt;:AbstractFloat, D}</code></pre><p>Defines a Holstein coupling between a specified phonon mode and orbital density. Specifically, if <code>shifted = true</code> a Holstein interaction term is given by</p><p class="math-container">\[\begin{align*}
H = \sum_{\mathbf{i}} \Big[ 
        &amp; (\alpha_{\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}_{\mathbf{i},\nu}
        + \alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^3_{\mathbf{i},\nu}) \ (\hat{n}_{\sigma,\mathbf{i}+\mathbf{r},\kappa}-\tfrac{1}{2})\\
        &amp; + (\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^2_{\mathbf{i},\nu}
        + \alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^4_{\mathbf{i},\nu}) \ \hat{n}_{\sigma,\mathbf{i}+\mathbf{r},\kappa} 
\Big]
\end{align*},\]</p><p>whereas if <code>shifted = false</code> then it is given by</p><p class="math-container">\[\begin{align*}
H = \sum_{\mathbf{i}} \Big[ 
        &amp; (\alpha_{\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}_{\mathbf{i},\nu}
        + \alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^3_{\mathbf{i},\nu}) \ \hat{n}_{\sigma,\mathbf{i}+\mathbf{r},\kappa}\\
        &amp; + (\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^2_{\mathbf{i},\nu}
        + \alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)} \hat{X}^4_{\mathbf{i},\nu}) \ \hat{n}_{\sigma,\mathbf{i}+\mathbf{r},\kappa} 
\Big]
\end{align*}.\]</p><p>In the above, <span>$\sigma$</span> specifies the sum, and the sum over <span>$\mathbf{i}$</span> runs over unit cells in the lattice. In the above <span>$\nu$</span> and <span>$\kappa$</span> specify orbital species in the unit cell, and <span>$\mathbf{r}$</span> is a static displacement in unit cells.</p><p><strong>Fields</strong></p><ul><li><code>shifted::Bool</code>: If the odd powered interaction terms are shifted to render them particle-hole symmetric in the atomic limit.</li><li><code>phonon_mode::Int</code>: The phonon mode getting coupled to.</li><li><code>bond::Bond{D}</code>: Static displacement from <span>$\hat{X}_{\mathbf{i},\nu}$</span> to <span>$\hat{n}_{\sigma,\mathbf{i}+\mathbf{r},\kappa}.$</span></li><li><code>bond_id::Int</code>: Bond ID associtated with <code>bond</code> field.</li><li><code>α_mean::E</code>: Mean of the linear Holstein coupling coefficient <span>$\alpha_{1,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α_std::E</code>: Standard deviation of the linear Holstein coupling coefficient <span>$\alpha_{1,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α2_mean::E</code>: Mean of the squared Holstein coupling coefficient <span>$\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α2_std::E</code>: Standard deviation of the squared Holstein coupling coefficient <span>$\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α3_mean::E</code>: Mean of the cubic Holstein coupling coefficient <span>$\alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α3_std::E</code>: Standard deviation of the cubic Holstein coupling coefficient <span>$\alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α4_mean::E</code>: Mean of the quartic Holstein coupling coefficient <span>$\alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α4_std::E</code>: Standard deviation of the quartic Holstein coupling coefficient <span>$\alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li></ul><p><strong>Comment</strong></p><p>Note that the initial orbital <code>bond.orbital[1]</code> must match the orbital species associated with phonon mode <a href="#SmoQyDQMC.PhononMode"><code>PhononMode</code></a> getting coupled to.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L65-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HolsteinCoupling-Tuple{}" href="#SmoQyDQMC.HolsteinCoupling-Tuple{}"><code>SmoQyDQMC.HolsteinCoupling</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HolsteinCoupling(;
    model_geometry::ModelGeometry{D,E},
    phonon_mode::Int,
    bond::Bond{D},
    α_mean::E,        α_std::E  = 0.0,
    α2_mean::E = 0.0, α2_std::E = 0.0,
    α3_mean::E = 0.0, α3_std::E = 0.0,
    α4_mean::E = 0.0, α4_std::E = 0.0,
    shifted::Bool = true
) where {D, E&lt;:AbstractFloat}</code></pre><p>Initialize and return a instance of <a href="#SmoQyDQMC.HolsteinCoupling"><code>HolsteinCoupling</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L153-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.SSHCoupling" href="#SmoQyDQMC.SSHCoupling"><code>SmoQyDQMC.SSHCoupling</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSHCoupling{T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Defines a Su-Schrieffer-Heeger (SSH) coupling between a pair of phonon modes. Specifically, it defines the SSH interaction term</p><p class="math-container">\[\hat{H}_{{\rm ssh}} = -\sum_{\sigma,\mathbf{i}}
    \left[ t_{\mathbf{i},(\mathbf{r},\kappa,\nu)} - \left( \sum_{n=1}^{4}\alpha_{n,\mathbf{i},(\mathbf{r},\kappa,\nu)}
    \left( \hat{X}_{\mathbf{i}+\mathbf{r},\kappa} - \hat{X}_{\mathbf{i},\nu}\right)^{n}\right) \right]
    \left( \hat{c}_{\sigma,\mathbf{i}+\mathbf{r},\kappa}^{\dagger}\hat{c}_{\sigma,\mathbf{i},\nu}+{\rm h.c.} \right),\]</p><p>where <span>$\sigma$</span> specifies the sum, and the sum over <span>$\mathbf{i}$</span> runs over unit cells in the lattice. In the above <span>$\nu$</span> and <span>$\kappa$</span> specify orbital species in the unit cell, and <span>$\mathbf{r}$</span> is a static displacement in unit cells. In that above expression <span>$t_{\mathbf{i},(\mathbf{r},\kappa,\nu)}$</span> is the bare hopping amplitude, which is not specified here.</p><p><strong>Fields</strong></p><ul><li><code>phonon_modes::NTuple{2,Int}</code>: Pair of phonon modes getting coupled together.</li><li><code>bond::Bond{D}</code>: Static displacement seperating the two phonon modes getting coupled.</li><li><code>bond_id::Int</code>: Bond ID associated with the <code>bond</code> field.</li><li><code>α_mean::T</code>: Mean of the linear SSH coupling constant <span>$\alpha_{1,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α_std::T</code>: Standard deviation of the linear SSH coupling constant <span>$\alpha_{1,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α2_mean::T</code>: Mean of the quadratic SSH coupling constant <span>$\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α2_std::T</code>: Standard deviation of the quadratic SSH coupling constant <span>$\alpha_{2,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α3_mean::T</code>: Mean of the cubic SSH coupling constant <span>$\alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α3_std::T</code>: Standard deviation of the cubic SSH coupling constant <span>$\alpha_{3,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α4_mean::T</code>: Mean of the quartic SSH coupling constant <span>$\alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>α4_std::T</code>: Standard deviation of the quartic SSH coupling constant <span>$\alpha_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li></ul><p><strong>Comment</strong></p><p>The pair of orbitals appearing in <code>bond.orbitals</code> must correspond to the orbital species associated with the two coupling phonon modes specified by <code>phonon_modes</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L183-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.SSHCoupling-Tuple{}" href="#SmoQyDQMC.SSHCoupling-Tuple{}"><code>SmoQyDQMC.SSHCoupling</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSHCoupling(;
    model_geometry::ModelGeometry{D,E},
    tight_binding_model::TightBindingModel{T,E,D},
    phonon_modes::NTuple{2,Int},
    bond::Bond{D},
    α_mean::Union{T,E},        α_std::E  = 0.0,
    α2_mean::Union{T,E} = 0.0, α2_std::E = 0.0,
    α3_mean::Union{T,E} = 0.0, α3_std::E = 0.0,
    α4_mean::Union{T,E} = 0.0, α4_std::E = 0.0
) where {D, T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Initialize and return a instance of <a href="#SmoQyDQMC.SSHCoupling"><code>SSHCoupling</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L254-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.PhononDispersion" href="#SmoQyDQMC.PhononDispersion"><code>SmoQyDQMC.PhononDispersion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhononDispersion{E&lt;:AbstractFloat, D}</code></pre><p>Defines a dispersive phonon coupling between phonon modes. Specifically, it defines the dispersive phonon term</p><p class="math-container">\[\hat{H}_{{\rm disp}} = \sum_{\mathbf{i}}
    \left(
        \frac{M_{\mathbf{i}+\mathbf{r},\kappa}M_{\mathbf{i},\nu}}{M_{\mathbf{i}+\mathbf{r},\kappa}+M_{\mathbf{i},\nu}}
    \right)
    \bigg[
                    \Omega_{\mathbf{i},(\mathbf{r},\kappa,\nu)}^{2}\Big(\hat{X}_{\mathbf{i}+\mathbf{r},\kappa}-\hat{X}_{\mathbf{i},\nu}\Big)^{2}
       +\frac{1}{12}\Omega_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}^{2}\Big(\hat{X}_{\mathbf{i}+\mathbf{r},\kappa}-\hat{X}_{\mathbf{i},\nu}\Big)^{4}
    \bigg]\]</p><p>where the sum over <span>$\mathbf{i}$</span> runs over unit cells in the lattice. In the above <span>$\nu$</span> and <span>$\kappa$</span> specify orbital species in the unit cell, and <span>$\mathbf{r}$</span> is a static displacement in unit cells.</p><p><strong>Fields</strong></p><ul><li><code>phonon_modes::NTuple{2,Int}</code>: Pair of phonon modes getting coupled together.</li><li><code>bond::Bond{D}</code>: Static displacement seperating the two phonon modes getting coupled.</li><li><code>bond_id::Int</code>: Bond ID associated with the <code>bond</code> field.</li><li><code>Ω_mean::E</code>: Mean dispersive phonon frequency <span>$\Omega_{\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>Ω_std::E</code>: Standard deviation of dispersive phonon frequency <span>$\Omega_{\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>Ω4_mean::E</code>: Mean quartic dispersive phonon coefficient <span>$\Omega_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li><li><code>Ω4_std::E</code>: Standard deviation of quartic dispersive phonon coefficient <span>$\Omega_{4,\mathbf{i},(\mathbf{r},\kappa,\nu)}.$</span></li></ul><p><strong>Comment</strong></p><p>The pair of orbitals appearing in <code>bond.orbitals</code> must correspond to the orbital species associated with the two coupling phonon modes specified by <code>phonon_modes</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L289-L321">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.PhononDispersion-Tuple{}" href="#SmoQyDQMC.PhononDispersion-Tuple{}"><code>SmoQyDQMC.PhononDispersion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhononDispersion(;
    model_geometry::ModelGeometry{D,E},
    phonon_modes::NTuple{2,Int},
    bond::Bond{D},
    Ω_mean::E, Ω_std::E=0.0,
    Ω4_mean::E=0.0, Ω4_std::E=0.0
) where {E&lt;:AbstractFloat, D}</code></pre><p>Initialize and return a instance of <a href="#SmoQyDQMC.PhononDispersion"><code>PhononDispersion</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L346-L356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.add_phonon_mode!" href="#SmoQyDQMC.add_phonon_mode!"><code>SmoQyDQMC.add_phonon_mode!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_phonon_mode!(;
    electron_phonon_model::ElectronPhononModel{T,E,D},
    phonon_mode::PhononMode{E}
) where {T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Add a <a href="#SmoQyDQMC.PhononMode"><code>PhononMode</code></a> to an <a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L673-L680">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.add_holstein_coupling!" href="#SmoQyDQMC.add_holstein_coupling!"><code>SmoQyDQMC.add_holstein_coupling!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_holstein_coupling!(;
    model_geometry::ModelGeometry{D,E},
    electron_phonon_model::ElectronPhononModel{T,E,D},
    holstein_coupling::Union{HolsteinCoupling{E,D}, Nothing} = nothing,
    holstein_coupling_up::Union{HolsteinCoupling{E,D}, Nothing} = nothing,
    holstein_coupling_dn::Union{HolsteinCoupling{E,D}, Nothing} = nothing
) where {T,E,D}</code></pre><p>Add the <a href="#SmoQyDQMC.HolsteinCoupling"><code>HolsteinCoupling</code></a> to an <a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a>. Note that either <code>holstein_coupling</code> or <code>holstein_coupling_up</code> and <code>holstein_coupling_dn</code> must be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L731-L742">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.add_ssh_coupling!" href="#SmoQyDQMC.add_ssh_coupling!"><code>SmoQyDQMC.add_ssh_coupling!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_ssh_coupling!(;
    electron_phonon_model::ElectronPhononModel{T,E,D},
    tight_binding_model::Union{TightBindingModel{T,E,D}, Nothing} = nothing,
    ssh_coupling::Union{SSHCoupling{T,E,D}, Nothing} = nothing,
    tight_binding_model_up::Union{TightBindingModel{T,E,D}, Nothing} = nothing,
    tight_binding_model_dn::Union{TightBindingModel{T,E,D}, Nothing} = nothing,
    ssh_coupling_up::Union{SSHCoupling{T,E,D}, Nothing} = nothing,
    ssh_coupling_dn::Union{SSHCoupling{T,E,D}, Nothing} = nothing
) where {T,E,D}</code></pre><p>Add a <a href="#SmoQyDQMC.SSHCoupling"><code>SSHCoupling</code></a> to an <a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a>. Note that either <code>ssh_coupling</code> and <code>tight_binding_model</code> or <code>ssh_coupling_up</code>, <code>ssh_coupling_dn</code>, <code>tight_binding_model_up</code> and <code>tight_binding_model_dn</code> need to be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L785-L800">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.add_phonon_dispersion!" href="#SmoQyDQMC.add_phonon_dispersion!"><code>SmoQyDQMC.add_phonon_dispersion!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_phonon_dispersion!(;
    electron_phonon_model::ElectronPhononModel{T,E,D},
    phonon_dispersion::PhononDispersion{E,D},
    model_geometry::ModelGeometry{D,E}
) where {T,E,D}</code></pre><p>Add a <a href="#SmoQyDQMC.PhononDispersion"><code>PhononDispersion</code></a> to an <a href="#SmoQyDQMC.ElectronPhononModel"><code>ElectronPhononModel</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononModel.jl#L693-L701">source</a></section></article><h3 id="Electron-Phonon-Parameter-Types-and-Methods"><a class="docs-heading-anchor" href="#Electron-Phonon-Parameter-Types-and-Methods">Electron-Phonon Parameter Types and Methods</a><a id="Electron-Phonon-Parameter-Types-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Parameter-Types-and-Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ElectronPhononParameters" href="#SmoQyDQMC.ElectronPhononParameters"><code>SmoQyDQMC.ElectronPhononParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElectronPhononParameters{T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Describes all parameters in the electron-phonon model.</p><p><strong>Fields</strong></p><ul><li><code>β::E</code>: Inverse temperature.</li><li><code>Δτ::E</code>: Discretization in imaginary time.</li><li><code>Lτ::Int</code>: Length of imaginary time axis.</li><li><code>x::Matrix{E}</code>: Phonon fields, where each column represents the phonon fields for a given imaginary time slice.</li><li><code>phonon_parameters::PhononParameters{E}</code>: Refer to <a href="#SmoQyDQMC.PhononParameters"><code>PhononParameters</code></a>.</li><li><code>holstein_parameters_up::HolsteinParameters{E}</code>: Spin up <a href="#SmoQyDQMC.HolsteinParameters"><code>HolsteinParameters</code></a>.</li><li><code>holstein_parameters_dn::HolsteinParameters{E}</code>: Spin down <a href="#SmoQyDQMC.HolsteinParameters"><code>HolsteinParameters</code></a>.</li><li><code>ssh_parameters_up::SSHParameters{T}</code>: Spin up <a href="#SmoQyDQMC.SSHParameters"><code>SSHParameters</code></a>.</li><li><code>ssh_parameters_dn::SSHParameters{T}</code>: Spin down <a href="#SmoQyDQMC.SSHParameters"><code>SSHParameters</code></a>.</li><li><code>dispersion_parameters::DispersionParameters{E}</code>: Refer to <a href="#SmoQyDQMC.DispersionParameters"><code>DispersionParameters</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.ElectronPhononParameters-Tuple{}" href="#SmoQyDQMC.ElectronPhononParameters-Tuple{}"><code>SmoQyDQMC.ElectronPhononParameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElectronPhononParameters(;
    β::E, Δτ::E,
    model_geometry::ModelGeometry{D,E},
    tight_binding_parameters::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    tight_binding_parameters_up::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    tight_binding_parameters_dn::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    electron_phonon_model::ElectronPhononModel{T,E,D},
    rng::AbstractRNG
) where {T,E,D}</code></pre><p>Initialize and return an instance of <a href="#SmoQyDQMC.ElectronPhononParameters"><code>ElectronPhononParameters</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L52-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.PhononParameters" href="#SmoQyDQMC.PhononParameters"><code>SmoQyDQMC.PhononParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhononParameters{E&lt;:AbstractFloat}</code></pre><p>Defines the parameters for each phonon in the lattice, includes the phonon field configuration.</p><p><strong>Fields</strong></p><ul><li><code>nphonon::Int</code>: Number of type of phonon modes.</li><li><code>Nphonon::Int</code>: Total number of phonon modes in finite lattice.</li><li><code>M::Int</code>: Mass of each phonon mode.</li><li><code>Ω::Int</code>: Frequency of each phonon mode.</li><li><code>Ω4::Int</code>: Quartic phonon coefficient for each phonon mode.</li><li><code>phonon_to_site::Vector{Int}</code>: Map each phonon to the site it lives on in the lattice.</li><li><code>site_to_phonons::Vector{Vector{Int}}</code>: Maps the site to the phonon modes on it, allowing for multiple modes to reside on a single site.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/PhononParameters.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HolsteinParameters" href="#SmoQyDQMC.HolsteinParameters"><code>SmoQyDQMC.HolsteinParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HolsteinParameters{E&lt;:AbstractFloat}</code></pre><p>Defines the Holstein coupling parameters in lattice.</p><p><strong>Fields</strong></p><ul><li><code>nholstein::Int</code>: The number of type of holstein couplings.</li><li><code>Nholstein::Int</code>: Total number of Holstein couplings in lattice.</li><li><code>α::Vector{T}</code>: Linear Holstein coupling.</li><li><code>α2::Vector{T}</code>: Quadratic Holstein coupling.</li><li><code>α3::Vector{T}</code>: Cubic Holstein coupling.</li><li><code>α4::Vector{T}</code>: Quartic Holstein coupling.</li><li><code>shifted::Vector{Bool}</code>: If the density multiplying the odd powered interaction terms is shifted.</li><li><code>neighbor_table::Matrix{Int}</code>: Neighbor table where the first row specifies the site where the phonon mode is located, and the second row specifies the site corresponding to the density getting coupled to.</li><li><code>coupling_to_phonon::Vector{Int}</code>: Maps each Holstein coupling in the lattice to the corresponding phonon mode.</li><li><code>phonon_to_coupling::Vector{Vector{Int}}</code>: Maps each phonon model to correspond Holstein couplings.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/HolsteinParameters.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.SSHParameters" href="#SmoQyDQMC.SSHParameters"><code>SmoQyDQMC.SSHParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSHParameters{T&lt;:Number}</code></pre><p>Defines the SSH coupling parameters in lattice.</p><p><strong>Fields</strong></p><ul><li><code>nssh::Int</code>: Number of types of SSH couplings.</li><li><code>Nssh::Int</code>: Number of SSH couplings in lattice.</li><li><code>α::Vector{T}</code>: Linear SSH coupling.</li><li><code>α2::Vector{T}</code>: Quadratic SSH coupling.</li><li><code>α3::Vector{T}</code>: Cubic SSH coupling.</li><li><code>α4::Vector{T}</code>: Quartic SSH coupling.`</li><li><code>neighbor_table::Matrix{Int}</code>: Neighbor table to SSH coupling.</li><li><code>coupling_to_phonon::Matrix{Int}</code>: Maps each SSH coupling onto that pair of coupled phonons.</li><li><code>init_phonon_to_coupling::Vector{Vector{Int}}</code>: Maps initial phonon mode to corresponding SSH coupling(s).</li><li><code>final_phonon_to_coupling::Vector{Vector{Int}}</code>: Maps final phonon mode to corresponding SSH coupling(s).</li><li><code>hopping_to_couplings::Vector{Vector{Int}}</code>: Maps hopping in the tight-binding model onto SSH couplings.</li><li><code>coupling_to_hopping::Vector{Int}</code>: Maps each SSH coupling onto the corresponding hopping in the tight-binding model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/SSHParameters.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.DispersionParameters" href="#SmoQyDQMC.DispersionParameters"><code>SmoQyDQMC.DispersionParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersionParameters{E&lt;:AbstractFloat}</code></pre><p>Defines the dispersive phonon coupling parameters in the lattice.</p><p><strong>Fields</strong></p><ul><li><code>ndispersion::Int</code>: Number of types of dispersive couplings.</li><li><code>Ndispersion::Int</code>: Number of dispersive couplings in the lattice.</li><li><code>Ω::Vector{E}</code>: Frequency of dispersive phonon coupling.</li><li><code>Ω4::Vector{E}</code>: Quartic coefficient for the phonon dispersion.</li><li><code>dispersion_to_phonon::Matrix{Int}</code>: Pair of phonon modes in lattice coupled by dispersive coupling.</li><li><code>init_phonon_to_coupling::Vector{Vector{Int}}</code>: Maps initial phonon mode to corresponding dispersive phonon coupling.</li><li><code>final_phonon_to_coupling::Vector{Vector{Int}}</code>: Maps final phonon mode to corresponding dispersive phonon coupling.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/DispersionParameters.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}}} where {T, E}" href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}}} where {T, E}"><code>SmoQyDQMC.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    electron_phonon_parameters::ElectronPhononParameters{T,E}
) where {T,E}</code></pre><p>Initialize the contribution of an <a href="#SmoQyDQMC.ElectronPhononParameters"><code>ElectronPhononParameters</code></a> to a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L156-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}}} where {T, E}" href="#SmoQyDQMC.initialize!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}}} where {T, E}"><code>SmoQyDQMC.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    fermion_path_integral::FermionPathIntegral{T,E},
    electron_phonon_parameters::ElectronPhononParameters{T,E};
    spin::Int = +1,
) where {T,E}</code></pre><p>Initialize the contribution of an <a href="#SmoQyDQMC.ElectronPhononParameters"><code>ElectronPhononParameters</code></a> to a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L180-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Matrix{E}}} where {T, E}" href="#SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Matrix{E}}} where {T, E}"><code>SmoQyDQMC.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    x′::Matrix{E},
    x::Matrix{E}
) where {T,E}</code></pre><p>Update a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> to reflect a change in the phonon configuration from <code>x</code> to <code>x′</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L214-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Matrix{E}}} where {T, E}" href="#SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Matrix{E}}} where {T, E}"><code>SmoQyDQMC.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(
    fermion_path_integral::FermionPathIntegral{T,E},
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    x′::Matrix{E},
    x::Matrix{E};
    spin::Int = +1
) where {T,E}</code></pre><p>Update a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> to reflect a change in the phonon configuration from <code>x</code> to <code>x′</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L242-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Int64}} where {T, E}" href="#SmoQyDQMC.update!-Union{Tuple{E}, Tuple{T}, Tuple{FermionPathIntegral{T, E}, ElectronPhononParameters{T, E}, Matrix{E}, Int64}} where {T, E}"><code>SmoQyDQMC.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(fermion_path_integral::FermionPathIntegral{T,E},
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    x::Matrix{E},
    sgn::Int;
    spin::Int = +1
) where {T,E}</code></pre><p>Update a <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> according to <code>sgn * x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ElectronPhononParameters.jl#L280-L289">source</a></section></article><h3 id="Electron-Phonon-Measurements"><a class="docs-heading-anchor" href="#Electron-Phonon-Measurements">Electron-Phonon Measurements</a><a id="Electron-Phonon-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Measurements" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_phonon_kinetic_energy" href="#SmoQyDQMC.measure_phonon_kinetic_energy"><code>SmoQyDQMC.measure_phonon_kinetic_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_phonon_kinetic_energy(electron_phonon_parameters::ElectronPhononParameters{T,E},
                              n::Int) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Evaluate the average phonon kinetic energy for phonon mode <code>n</code>. The measurement is made using the expression</p><p class="math-container">\[\langle K \rangle = \frac{1}{2\Delta\tau} - \frac{M}{2}\bigg\langle\frac{(x_{l+1}-x_{l})^{2}}{\Delta\tau^{2}}\bigg\rangle. \]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/phonon_measurements.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_phonon_potential_energy" href="#SmoQyDQMC.measure_phonon_potential_energy"><code>SmoQyDQMC.measure_phonon_potential_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_phonon_potential_energy(electron_phonon_parameters::ElectronPhononParameters{T,E},
                                n::Int) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the average phonon potential energy, given by</p><p class="math-container">\[U = \frac{1}{2} M \Omega^2 \langle \hat{X}^2 \rangle + \frac{1}{24} M \Omega_4^2 \langle \hat{X}^4 \rangle,\]</p><p>for phonon mode <code>n</code> in the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/phonon_measurements.jl#L68-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_phonon_position_moment" href="#SmoQyDQMC.measure_phonon_position_moment"><code>SmoQyDQMC.measure_phonon_position_moment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_phonon_position_moment(electron_phonon_parameters::ElectronPhononParameters{T,E},
                               n::Int, m::Int) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Measure <span>$\langle X^m \rangle$</span> for phonon mode <code>n</code> in the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/phonon_measurements.jl#L132-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_holstein_energy" href="#SmoQyDQMC.measure_holstein_energy"><code>SmoQyDQMC.measure_holstein_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_holstein_energy(
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    Gup::Matrix{T}, Gdn::Matrix{T},
    holstein_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate and return both the spin-resolved Holstein interaction energy</p><p class="math-container">\[\epsilon_{{\rm hol},\sigma} = 
                            \left\langle
                                [
                                    \alpha   \hat{X}   + \alpha_2 \hat{X}^2
                                  + \alpha_3 \hat{X}^3 + \alpha_4 \hat{X}^4
                                ]
                                \left(
                                    \hat{n}_\sigma - \frac{1}{2}
                                \right)
                            \right\rangle,\]</p><p>and the total Holstein interaction energy coupling definition corresponding to <code>holstein_id</code>. The method returns <code>(ϵ_hol, ϵ_hol_up, ϵ_hol_dn)</code> where <code>ϵ_hol = ϵ_hol_up + ϵ_hol_dn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/holstein_measurements.jl#L5-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_ssh_energy" href="#SmoQyDQMC.measure_ssh_energy"><code>SmoQyDQMC.measure_ssh_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_ssh_energy(
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    Gup::Matrix{T}, Gdn::Matrix{T},
    ssh_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the return the SSH interaction energy</p><p class="math-container">\[\epsilon_{\rm ssh} = \sum_\sigma \left\langle [\alpha \hat{X}     + \alpha_2 \hat{X}^2
                                               \alpha_3 \hat{X}^3 + \alpha_4 \hat{X}^4]
                                              (\hat{c}^\dagger_{\sigma,i} \hat{c}_{\sigma,j} + {\rm h.c.}) \right\rangle\]</p><p>for coupling definition specified by <code>ssh_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ssh_measurements.jl#L5-L19">source</a></section><section><div><pre><code class="language-julia hljs">measure_ssh_energy(
    ssh_parameters::SSHParameters{T},
    G::Matrix{T}, x::Matrix{E}, ssh_id::Int
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the return the SSH interaction energy</p><p class="math-container">\[\epsilon_{\rm ssh} = \left\langle [\alpha \hat{X}     + \alpha_2 \hat{X}^2
                                   \alpha_3 \hat{X}^3 + \alpha_4 \hat{X}^4]
                        (\hat{c}^\dagger_{\sigma,i} \hat{c}_{\sigma,j} + {\rm h.c.}) \right\rangle\]</p><p>for coupling definition specified by <code>ssh_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ssh_measurements.jl#L34-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_ssh_sgn_switch" href="#SmoQyDQMC.measure_ssh_sgn_switch"><code>SmoQyDQMC.measure_ssh_sgn_switch</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_ssh_sgn_switch(
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    tight_binding_parameters::TightBindingParameters{T,E},
    ssh_id::Int;
    spin::Int = +1
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Calculate the fraction of the time the sign of the hopping is changed as a result of the SSH coupling associated with <code>ssh_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/ssh_measurements.jl#L96-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.measure_dispersion_energy" href="#SmoQyDQMC.measure_dispersion_energy"><code>SmoQyDQMC.measure_dispersion_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measure_dispersion_energy(electron_phonon_parameters::ElectronPhononParameters{T,E},
                       dispersion_id::Int) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Evaluate the average dispersion energy</p><p class="math-container">\[\epsilon_{\rm disp} = \frac{1}{2} M_{\rm red} \Omega^2 \langle(\hat{X}_i - \hat{X}_j)^2\rangle
                    + \frac{1}{24} M{\rm red} \Omega_4^2 \langle(\hat{X}_i - \hat{X}_j)^4\rangle,\]</p><p>where <span>$M_{\rm red} = \frac{M_i M_j}{M_i + M_j}$</span> is the reduced mass, for the dispersive coupling definition specified by <code>dispersion_id</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/dispersion_measurements.jl#L1-L12">source</a></section></article><h3 id="Electron-Phonon-Updates"><a class="docs-heading-anchor" href="#Electron-Phonon-Updates">Electron-Phonon Updates</a><a id="Electron-Phonon-Updates-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-Phonon-Updates" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HMCUpdater" href="#SmoQyDQMC.HMCUpdater"><code>SmoQyDQMC.HMCUpdater</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HMCUpdater{T&lt;:Number, E&lt;:AbstractFloat, PFFT, PIFFT}</code></pre><p>Defines a hybrid/hamiltonian monte carlo (HMC) update for the phonon degrees of freedom.</p><p><strong>Fields</strong></p><ul><li><code>Nt::Int</code>: Mean trajectory length in terms of the number of fermionic time-steps.</li><li><code>Δt::E</code>: Average fermionic time-step size used in HMC update.</li><li><code>nt::Int</code>: Number of bosonic time-steps per fermionic time-step using a bosonic time-step <code>Δt′=Δt/nt</code>.</li><li><code>δ::E</code>: Time-step used in HMC update is jittered by an amount <code>Δt = Δt * (1 + δ*(2*rand(rng)-1))</code>.</li><li><code>M::FourierMassMatrix{E,PFFT,PIFFT}</code>: Defines the <a href="#SmoQyDQMC.FourierMassMatrix"><code>FourierMassMatrix</code></a>.</li><li><code>dSdx::Matrix{E}</code>: Array to contain derivative of fermionic and bosonic action during HMC trajectory.</li><li><code>dSfdx0::Matrix{E}</code>: Initial derivative of fermionic action associated with the initial phonon configuration.</li><li><code>Gup′::Matrix{T}</code>: Matrix to contain itermediate spin-up Green&#39;s function matrices.</li><li><code>Gdn′::Matrix{T}</code>: Matrix to contain itermediate spin-down Green&#39;s function matrices.</li><li><code>x′::Matrix{E}</code>: Array to record intermediate phonon configurations.</li><li><code>x0::Matrix{E}</code>: Array to record initial phonon configuration.</li><li><code>v::Matrix{E}</code>: Conjugate momentum to phonon fields in HMC trajectory.</li><li><code>first_update::Bool</code>: A flag indicating whether the next update will be the first update</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/HMCUpdater.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.HMCUpdater-Tuple{}" href="#SmoQyDQMC.HMCUpdater-Tuple{}"><code>SmoQyDQMC.HMCUpdater</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HMCUpdater(;
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    G::Matrix{T},
    Nt::Int,
    Δt::E,
    nt::Int,
    reg::E
) where {T,E}</code></pre><p>Initialize and return an instance of <a href="#SmoQyDQMC.HMCUpdater"><code>HMCUpdater</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Defines electron phonon model.</li><li><code>G::Matrix{T}</code>: Template Green&#39;s function matrix.</li><li><code>Nt::Int</code>: Number of fermionic timesteps in HMC trajectory.</li><li><code>Δt::E</code>: Fermionic time-step.</li><li><code>nt::Int</code>: Number of bosonic time-steps per fermionic time-step.</li><li><code>reg::E</code>: Regularization parameter for defining an instance of <a href="#SmoQyDQMC.FourierMassMatrix"><code>FourierMassMatrix</code></a>.</li><li><code>δ::E = 0.05</code>: Proportion by which the HMC time-step is jittered befored each update.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/HMCUpdater.jl#L64-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.EFAHMCUpdater" href="#SmoQyDQMC.EFAHMCUpdater"><code>SmoQyDQMC.EFAHMCUpdater</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EFAHMCUpdater{T&lt;:Number, E&lt;:AbstractFloat, PFFT, PIFFT}</code></pre><p>Defines an Exact Fourier Acceleration Hamiltonian/Hybrid Monte Carlo (EFA-HMC) update for the phonon degrees of freedom.</p><p><strong>Fields</strong></p><ul><li><code>Nt::Int</code>: Number of time-steps in HMC trajectory.</li><li><code>Δt::E</code>: Average time-step size used in HMC update.</li><li><code>δ::E</code>: Time-step used in EFA-HMC update is jittered by an amount <code>Δt = Δt * (1 + δ*(2*rand(rng)-1))</code>.</li><li><code>x::Matrix{E}</code>: Records initial phonon configuration in position space.</li><li><code>p::Matrix{E}</code>: Conjugate momentum in HMC dynamics.</li><li><code>dSdx::Matrix{E}</code>: Stores the derivative of the action.</li><li><code>Gup′::Matrix{T}</code>: Intermediate spin-up Green&#39;s function matrix during HMC trajectory.</li><li><code>Gdn′::Matrix{T}</code>: Intermediate spin-down Green&#39;s function matrix during HMC trajectory.</li><li><code>efa::ExactFourierAccelerator{E,PFFT,PIFFT}</code>: Type to perform exact integration of equations of motion of quantum harmonic oscillator. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/EFAHMCUpdater.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.EFAHMCUpdater-Tuple{}" href="#SmoQyDQMC.EFAHMCUpdater-Tuple{}"><code>SmoQyDQMC.EFAHMCUpdater</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EFAHMCUpdater(;
    # Keyword Arguments Start Here
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    G::Matrix{T},
    Nt::Int,
    Δt::E,
    reg::E = 0.0,
    δ::E = 0.05
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p><strong>Arguments</strong></p><ul><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Defines electron-phonon model.</li><li><code>G::Matrix{T}</code>: Sample Green&#39;s function matrix.</li><li><code>Nt::Int</code>: Number of time-steps used in EFA-HMC update.</li><li><code>Δt::E</code>: Average step size used for HMC update.</li><li><code>reg::E = Inf</code>: Regularization used for mass in equations of motion.</li><li><code>δ::E = 0.05</code>: Amount of jitter added to time-step used in EFA-HMC update.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/EFAHMCUpdater.jl#L49-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}, HMCUpdater{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}, HMCUpdater{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.hmc_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hmc_update!(
    Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
    Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    hmc_updater::HMCUpdater{T,E};
    # Keyword Arguments Start Here
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    fermion_greens_calculator_up::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
    fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
    Bup::Vector{P}, Bdn::Vector{P},
    δG_max::E, δG::E, δθ::E, rng::AbstractRNG,
    update_stabilization_frequency::Bool = true,
    initialize_force::Bool = true,
    δG_reject::E = 1e-2,
    recenter!::Function = identity,
    Nt::Int = hmc_updater.Nt,
    nt::Int = hmc_updater.nt,
    Δt::E = hmc_updater.Δt,
    δ::E = hmc_updater.δ
) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform HMC update to the phonon degrees of freedom. This method returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn, δG, δθ)</code>, where <code>accepted</code> is a boolean field indicating whether the proposed HMC update was accepted or rejected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/HMCUpdater.jl#L115-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}, HMCUpdater{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}, HMCUpdater{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.hmc_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hmc_update!(
    G::Matrix{T}, logdetG::E, sgndetG::T,
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    hmc_updater::HMCUpdater{T,E};
    # Keyword Arguments Start Here
    fermion_path_integral::FermionPathIntegral{T,E},
    fermion_greens_calculator::FermionGreensCalculator{T,E},
    fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
    B::Vector{P}, δG_max::E, δG::E, δθ::E, rng::AbstractRNG,
    update_stabilization_frequency::Bool = true,
    initialize_force::Bool = true,
    δG_reject::E = 1e-2,
    recenter!::Function = identity,
    Nt::Int = hmc_updater.Nt,
    nt::Int = hmc_updater.nt,
    Δt::E = hmc_updater.Δt,
    δ::E = hmc_updater.δ
) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform HMC update to the phonon degrees of freedom assuming the spin-up and spin-down sectors are equivalent. This method returns <code>(accepted, logdetG, sgndetG, δG, δθ)</code>, where <code>accepted</code> is a boolean field indicating whether the proposed HMC update was accepted or rejected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/HMCUpdater.jl#L191-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}, EFAHMCUpdater{T, E}}} where {T, E, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}, EFAHMCUpdater{T, E}}} where {T, E, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.hmc_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hmc_update!(
    Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
    Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    hmc_updater::EFAHMCUpdater{T,E};
    # Keyword Arguments Start Here
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    fermion_greens_calculator_up::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
    fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
    Bup::Vector{P}, Bdn::Vector{P},
    δG_max::E, δG::E, δθ::E, rng::AbstractRNG,
    update_stabilization_frequency::Bool = true,
    δG_reject::E = 1e-2,
    recenter!::Function = identity,
    Nt::Int = hmc_updater.Nt,
    Δt::E = hmc_updater.Δt,
    δ::E = hmc_updater.δ
) where {T, E, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform EFA-HMC update to the phonon degrees of freedom. This method returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn, δG, δθ)</code>, where <code>accepted</code> is a boolean field indicating whether the proposed HMC update was accepted or rejected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/EFAHMCUpdater.jl#L93-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}, EFAHMCUpdater{T, E}}} where {T, E, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.hmc_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}, EFAHMCUpdater{T, E}}} where {T, E, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.hmc_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hmc_update!(
    G::Matrix{T}, logdetG::E, sgndetG::T,
    electron_phonon_parameters::ElectronPhononParameters{T,E},
    hmc_updater::EFAHMCUpdater{T,E};
    fermion_path_integral::FermionPathIntegral{T,E},
    fermion_greens_calculator::FermionGreensCalculator{T,E},
    fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
    B::Vector{P},
    δG_max::E, δG::E, δθ::E, rng::AbstractRNG,
    update_stabilization_frequency::Bool = true,
    δG_reject::E = 1e-2,
    recenter!::Function = identity,
    Nt::Int = hmc_updater.Nt,
    Δt::E = hmc_updater.Δt,
    δ::E = hmc_updater.δ
) where {T, E, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Perform EFA-HMC update to the phonon degrees of freedom. This method returns <code>(accepted, logdetG, sgndetG, δG, δθ)</code>, where <code>accepted</code> is a boolean field indicating whether the proposed HMC update was accepted or rejected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/EFAHMCUpdater.jl#L410-L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.FourierMassMatrix" href="#SmoQyDQMC.FourierMassMatrix"><code>SmoQyDQMC.FourierMassMatrix</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FourierMassMatrix{E&lt;:AbstractFloat, PFFT, PIFFT}</code></pre><p>Defines the mass matrix that implements fourier acceleration when performing either hybrid/hamiltonian monte carlo or langevin monte carlo updates to the phonon fields.</p><p><strong>Fields</strong></p><ul><li><code>M̃::Matrix{E}</code>: Matrix elements of fourier mass matrix in frequency space.</li><li><code>v′::Matrix{Complex{E}}</code>: Temporary storage array to contain velocities as complex numbers to avoid dynamic memory allocations.</li><li><code>ṽ::Matrix{Complex{E}}</code>: Temporary storage to avoid some dynamic memory allocations when performing fourier transforms.</li><li><code>pfft::PFFT</code>: Forward FFT plan to perform transformation from imaginary time to frequency space without allocations.</li><li><code>pifft::PIFFT</code>: Inverse FFT plan to perform transformation from frequency to imaginary time space without allocations.</li><li><code>is_scalar::Bool</code>: If the mass matrix is equivalent to a simple scalar.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/FourierMassMatrix.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.reflection_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflection_update!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
                   Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
                   electron_phonon_parameters::ElectronPhononParameters{T,E};
                   fermion_path_integral_up::FermionPathIntegral{T,E},
                   fermion_path_integral_dn::FermionPathIntegral{T,E},
                   fermion_greens_calculator_up::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
                   Bup::Vector{P}, Bdn::Vector{P}, rng::AbstractRNG,
                   phonon_types = nothing) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Randomly sample a phonon mode in the lattice, and propose an update that reflects all the phonon fields associated with that phonon mode <span>$x \rightarrow -x.$</span> This function returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Gup::Matrix{T}</code>: Spin-up eqaul-time Greens function matrix.</li><li><code>logdetGup::E</code>: Log of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>sgndetGup::T</code>: Sign/phase of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>Gdn::Matrix{T}</code>: Spin-down eqaul-time Greens function matrix.</li><li><code>logdetGdn::E</code>: Log of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>sgndetGdn::T</code>: Sign/phase of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Electron-phonon parameters, including the current phonon configuration.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral_up::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-up electrons.</li><li><code>fermion_path_integral_dn::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-down electrons.</li><li><code>fermion_greens_calculator_up::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-up sector state.</li><li><code>fermion_greens_calculator_dn::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-down sector state.</li><li><code>fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>Bup::Vector{P}</code>: Spin-up propagators for each imaginary time slice.</li><li><code>Bdn::Vector{P}</code>: Spin-down propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>phonon_types = nothing</code>: Collection of phonon types in the unit cell to randomly sample a phonon mode from. If <code>nothing</code> then all phonon modes in the unit cell are considered.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/reflection_update.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.reflection_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.reflection_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflection_update!(G::Matrix{T}, logdetG::E, sgndetG::T,
                   electron_phonon_parameters::ElectronPhononParameters{T,E};
                   fermion_path_integral::FermionPathIntegral{T,E},
                   fermion_greens_calculator::FermionGreensCalculator{T,E},
                   fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
                   B::Vector{P}, rng::AbstractRNG,
                   phonon_types = nothing) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Randomly sample a phonon mode in the lattice, and propose an update that reflects all the phonon fields associated with that phonon mode <span>$x \rightarrow -x.$</span> This function returns <code>(accepted, logdetG, sgndetG)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>G::Matrix{T}</code>: Eqaul-time Greens function matrix.</li><li><code>logdetG::E</code>: Log of the determinant of the eqaul-time Greens function matrix.</li><li><code>sgndetG::T</code>: Sign/phase of the determinant of the eqaul-time Greens function matrix.</li><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Electron-phonon parameters, including the current phonon configuration.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type.</li><li><code>fermion_greens_calculator::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current state.</li><li><code>fermion_greens_calculator_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed state.</li><li><code>B::Vector{P}</code>: Propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>phonon_types = nothing</code>: Collection of phonon types in the unit cell to randomly sample a phonon mode from. If <code>nothing</code> then all phonon modes in the unit cell are considered.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/reflection_update.jl#L186-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.swap_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">swap_update!(Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
             Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T,
             electron_phonon_parameters::ElectronPhononParameters{T,E};
             fermion_path_integral_up::FermionPathIntegral{T,E},
             fermion_path_integral_dn::FermionPathIntegral{T,E},
             fermion_greens_calculator_up::FermionGreensCalculator{T,E},
             fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
             fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E},
             fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E},
             Bup::Vector{P}, Bdn::Vector{P}, rng::AbstractRNG,
             phonon_type_pairs = nothing) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Randomly sample a pairs of phonon modes and exchange the phonon fields associated with the pair of phonon modes. This function returns <code>(accepted, logdetGup, sgndetGup, logdetGdn, sgndetGdn)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Gup::Matrix{T}</code>: Spin-up eqaul-time Greens function matrix.</li><li><code>logdetGup::E</code>: Log of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>sgndetGup::T</code>: Sign/phase of the determinant of the spin-up eqaul-time Greens function matrix.</li><li><code>Gdn::Matrix{T}</code>: Spin-down eqaul-time Greens function matrix.</li><li><code>logdetGdn::E</code>: Log of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>sgndetGdn::T</code>: Sign/phase of the determinant of the spin-down eqaul-time Greens function matrix.</li><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Electron-phonon parameters, including the current phonon configuration.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral_up::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-up electrons.</li><li><code>fermion_path_integral_dn::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type for spin-down electrons.</li><li><code>fermion_greens_calculator_up::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-up sector state.</li><li><code>fermion_greens_calculator_dn::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current spin-down sector state.</li><li><code>fermion_greens_calculator_up_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>fermion_greens_calculator_dn_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed spin-up sector state.</li><li><code>Bup::Vector{P}</code>: Spin-up propagators for each imaginary time slice.</li><li><code>Bdn::Vector{P}</code>: Spin-down propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>phonon_type_pairs = nothing</code>: Collection of phonon type pairs in the unit cell to randomly sample a phonon modes from. If <code>nothing</code> then all phonon mode pairs in the unit cell are considered.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/swap_update.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}" href="#SmoQyDQMC.swap_update!-Union{Tuple{P}, Tuple{E}, Tuple{T}, Tuple{Matrix{T}, E, T, ElectronPhononParameters{T, E}}} where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T, E}}"><code>SmoQyDQMC.swap_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">swap_update!(G::Matrix{T}, logdetG::E, sgndetG::T,
             electron_phonon_parameters::ElectronPhononParameters{T,E};
             fermion_path_integral::FermionPathIntegral{T,E},
             fermion_greens_calculator::FermionGreensCalculator{T,E},
             fermion_greens_calculator_alt::FermionGreensCalculator{T,E},
             B::Vector{P}, rng::AbstractRNG,
             phonon_type_pairs = nothing) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Randomly sample a pairs of phonon modes and exchange the phonon fields associated with the pair of phonon modes. This function returns <code>(accepted, logdetG, sgndetG)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>G::Matrix{T}</code>: Eqaul-time Greens function matrix.</li><li><code>logdetG::E</code>: Log of the determinant of the eqaul-time Greens function matrix.</li><li><code>sgndetG::T</code>: Sign/phase of the determinant of the eqaul-time Greens function matrix.</li><li><code>electron_phonon_parameters::ElectronPhononParameters{T,E}</code>: Electron-phonon parameters, including the current phonon configuration.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fermion_path_integral::FermionPathIntegral{T,E}</code>: An instance of <a href="#SmoQyDQMC.FermionPathIntegral"><code>FermionPathIntegral</code></a> type.</li><li><code>fermion_greens_calculator::FermionGreensCalculator{T,E}</code>: Contains matrix factorization information for current state.</li><li><code>fermion_greens_calculator_alt::FermionGreensCalculator{T,E}</code>: Used to calculate matrix factorizations for proposed state.</li><li><code>B::Vector{P}</code>: Propagators for each imaginary time slice.</li><li><code>rng::AbstractRNG</code>: Random number generator used in method instead of global random number generator, important for reproducibility.</li><li><code>phonon_type_pairs = nothing</code>: Collection of phonon type pairs in the unit cell to randomly sample a phonon modes from. If <code>nothing</code> then all phonon mode pairs in the unit cell are considered.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/ElectronPhonon/swap_update.jl#L188-L215">source</a></section></article><h2 id="Density-and-Chemical-Potential-Tuning"><a class="docs-heading-anchor" href="#Density-and-Chemical-Potential-Tuning">Density and Chemical Potential Tuning</a><a id="Density-and-Chemical-Potential-Tuning-1"></a><a class="docs-heading-anchor-permalink" href="#Density-and-Chemical-Potential-Tuning" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.update_chemical_potential!"><code>update_chemical_potential!</code></a></li><li><a href="#SmoQyDQMC.save_density_tuning_profile"><code>save_density_tuning_profile</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.update_chemical_potential!" href="#SmoQyDQMC.update_chemical_potential!"><code>SmoQyDQMC.update_chemical_potential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_chemical_potential!(
    Gup::Matrix{T}, logdetGup::E, sgndetGup::T,
    Gdn::Matrix{T}, logdetGdn::E, sgndetGdn::T;
    chemical_potential_tuner::MuTunerLogger{E,T},
    tight_binding_parameters::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    tight_binding_parameters_up::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    tight_binding_parameters_dn::Union{TightBindingParameters{T,E}, Nothing} = nothing,
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    fermion_greens_calculator_up::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
    Bup::Vector{P}, Bdn::Vector{P}
) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Update the chemical potential <span>$\mu$</span> in the simulation to approach the target density/filling. This method returns the new values for <code>(logdetGup, sgndetGup, logdetGup, sgndetGup)</code>. Note that either the keywork <code>tight_binding_parameters</code> needs to be specified, or <code>tight_binding_parameters_up</code> and <code>tight_binding_parameters_dn</code> both need to be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/update_chemical_potential.jl#L1-L20">source</a></section><section><div><pre><code class="language-julia hljs">update_chemical_potential!(
    G::Matrix{T}, logdetG::E, sgndetG::T;
    chemical_potential_tuner::MuTunerLogger{E,T},
    tight_binding_parameters::TightBindingParameters{T,E},
    fermion_path_integral::FermionPathIntegral{T,E},
    fermion_greens_calculator::FermionGreensCalculator{T,E},
    B::Vector{P}
) where {T&lt;:Number, E&lt;:AbstractFloat, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Update the chemical potential <span>$\mu$</span> in the simulation to approach the target density/filling. This method returns the new values for <code>(logdetG, sgndetG)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/update_chemical_potential.jl#L80-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.save_density_tuning_profile" href="#SmoQyDQMC.save_density_tuning_profile"><code>SmoQyDQMC.save_density_tuning_profile</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_density_tuning_profile(simulation_info::SimulationInfo,
                            chemical_potential_tuner::MuTunerLogger{E,T}) where {E,T}</code></pre><p>Write the full density tuning history to a CSV file, typically done at the end of a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/update_chemical_potential.jl#L134-L139">source</a></section></article><h2 id="Measurement-Methods"><a class="docs-heading-anchor" href="#Measurement-Methods">Measurement Methods</a><a id="Measurement-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Measurement-Methods" title="Permalink"></a></h2><ul><li><a href="#SmoQyDQMC.GLOBAL_MEASUREMENTS"><code>GLOBAL_MEASUREMENTS</code></a></li><li><a href="#SmoQyDQMC.LOCAL_MEASUREMENTS"><code>LOCAL_MEASUREMENTS</code></a></li><li><a href="#SmoQyDQMC.CORRELATION_FUNCTIONS"><code>CORRELATION_FUNCTIONS</code></a></li></ul><p><strong>Initialize Measurements</strong></p><ul><li><a href="#SmoQyDQMC.initialize_measurement_container"><code>initialize_measurement_container</code></a></li><li><a href="#SmoQyDQMC.initialize_measurements!"><code>initialize_measurements!</code></a></li><li><a href="#SmoQyDQMC.initialize_correlation_measurements!"><code>initialize_correlation_measurements!</code></a></li><li><a href="#SmoQyDQMC.initialize_composite_correlation_measurement!"><code>initialize_composite_correlation_measurement!</code></a></li><li><a href="#SmoQyDQMC.initialize_measurement_directories"><code>initialize_measurement_directories</code></a></li></ul><p><strong>Make Measurements</strong></p><ul><li><a href="#SmoQyDQMC.make_measurements!"><code>make_measurements!</code></a></li></ul><p><strong>Write Measurements</strong></p><ul><li><a href="#SmoQyDQMC.write_measurements!"><code>write_measurements!</code></a></li></ul><p><strong>Process Measurements</strong></p><ul><li><a href="#SmoQyDQMC.save_simulation_info"><code>save_simulation_info</code></a></li><li><a href="#SmoQyDQMC.process_measurements"><code>process_measurements</code></a></li><li><a href="#SmoQyDQMC.process_correlation_measurement"><code>process_correlation_measurement</code></a></li><li><a href="#SmoQyDQMC.composite_correlation_stat"><code>composite_correlation_stat</code></a></li><li><a href="#SmoQyDQMC.global_measurement_bins_to_csv"><code>global_measurement_bins_to_csv</code></a></li><li><a href="#SmoQyDQMC.local_measurement_bins_to_csv"><code>local_measurement_bins_to_csv</code></a></li><li><a href="#SmoQyDQMC.correlation_bins_to_csv"><code>correlation_bins_to_csv</code></a></li><li><a href="#SmoQyDQMC.compress_jld2_bins"><code>compress_jld2_bins</code></a></li><li><a href="#SmoQyDQMC.decompress_jld2_bins"><code>decompress_jld2_bins</code></a></li><li><a href="#SmoQyDQMC.delete_jld2_bins"><code>delete_jld2_bins</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.GLOBAL_MEASUREMENTS" href="#SmoQyDQMC.GLOBAL_MEASUREMENTS"><code>SmoQyDQMC.GLOBAL_MEASUREMENTS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const GLOBAL_MEASUREMENTS = (
    &quot;logdetGup&quot;,
    &quot;logdetGdn&quot;,
    &quot;sgndetGup&quot;,
    &quot;sgndetGdn&quot;,
    &quot;sgn&quot;,
    &quot;action_total&quot;,
    &quot;action_bosonic&quot;,
    &quot;action_fermionic&quot;,
    &quot;density&quot;,
    &quot;density_up&quot;,
    &quot;density_dn&quot;,
    &quot;double_occ&quot;,
    &quot;Nsqrd&quot;
)</code></pre><p>List of all the global measurements that are made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/measurement_names.jl#L149-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.LOCAL_MEASUREMENTS" href="#SmoQyDQMC.LOCAL_MEASUREMENTS"><code>SmoQyDQMC.LOCAL_MEASUREMENTS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const LOCAL_MEASUREMENTS = Base.ImmutableDict(
    &quot;density&quot;                  =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_up&quot;               =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_dn&quot;               =&gt; &quot;ORBITAL_ID&quot;,
    &quot;double_occ&quot;               =&gt; &quot;ORBITAL_ID&quot;,
    &quot;onsite_energy&quot;            =&gt; &quot;ORBITAL_ID&quot;,
    &quot;onsite_energy_up&quot;         =&gt; &quot;ORBITAL_ID&quot;,
    &quot;onsite_energy_dn&quot;         =&gt; &quot;ORBITAL_ID&quot;,
    &quot;bare_hopping_energy&quot;      =&gt; &quot;HOPPING_ID&quot;,
    &quot;bare_hopping_energy_up&quot;   =&gt; &quot;HOPPING_ID&quot;,
    &quot;bare_hopping_energy_dn&quot;   =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_energy&quot;           =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_energy_up&quot;        =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_energy_dn&quot;        =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_amplitude_up&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_amplitude_dn&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_amplitude&quot;        =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion_avg_up&quot; =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion_avg_dn&quot; =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion_avg&quot;    =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion_up&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion_dn&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;hopping_inversion&quot;        =&gt; &quot;HOPPING_ID&quot;,
    &quot;hubbard_energy&quot;           =&gt; &quot;ORBITAL_ID&quot;,
    &quot;phonon_kin_energy&quot;        =&gt; &quot;PHONON_ID&quot;,
    &quot;phonon_pot_energy&quot;        =&gt; &quot;PHONON_ID&quot;,
    &quot;X&quot;                        =&gt; &quot;PHONON_ID&quot;,
    &quot;X2&quot;                       =&gt; &quot;PHONON_ID&quot;,
    &quot;X3&quot;                       =&gt; &quot;PHONON_ID&quot;,
    &quot;X4&quot;                       =&gt; &quot;PHONON_ID&quot;,
    &quot;holstein_energy&quot;          =&gt; &quot;HOLSTEIN_ID&quot;,
    &quot;holstein_energy_up&quot;       =&gt; &quot;HOLSTEIN_ID&quot;,
    &quot;holstein_energy_dn&quot;       =&gt; &quot;HOLSTEIN_ID&quot;,
    &quot;ssh_energy&quot;               =&gt; &quot;SSH_ID&quot;,
    &quot;ssh_energy_up&quot;            =&gt; &quot;SSH_ID&quot;,
    &quot;ssh_energy_dn&quot;            =&gt; &quot;SSH_ID&quot;,
    &quot;dispersion_energy&quot;        =&gt; &quot;DISPERSION_ID&quot;
)</code></pre><p>List of all the local measurements than can be made, with a mapping to the corresponding type of ID each measurement is reported in terms of.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/measurement_names.jl#L67-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.CORRELATION_FUNCTIONS" href="#SmoQyDQMC.CORRELATION_FUNCTIONS"><code>SmoQyDQMC.CORRELATION_FUNCTIONS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CORRELATION_FUNCTIONS = Base.ImmutableDict(
    &quot;greens&quot;           =&gt; &quot;ORBITAL_ID&quot;,
    &quot;greens_up&quot;        =&gt; &quot;ORBITAL_ID&quot;,
    &quot;greens_dn&quot;        =&gt; &quot;ORBITAL_ID&quot;,
    &quot;greens_tautau&quot;    =&gt; &quot;ORBITAL_ID&quot;,
    &quot;greens_tautau_up&quot; =&gt; &quot;ORBITAL_ID&quot;,
    &quot;greens_tautau_dn&quot; =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density&quot;          =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_upup&quot;     =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_dndn&quot;     =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_updn&quot;     =&gt; &quot;ORBITAL_ID&quot;,
    &quot;density_dnup&quot;     =&gt; &quot;ORBITAL_ID&quot;,
    &quot;spin_x&quot;           =&gt; &quot;ORBITAL_ID&quot;,
    &quot;spin_z&quot;           =&gt; &quot;ORBITAL_ID&quot;,
    &quot;pair&quot;             =&gt; &quot;BOND_ID&quot;,
    &quot;bond&quot;             =&gt; &quot;BOND_ID&quot;,
    &quot;bond_upup&quot;        =&gt; &quot;BOND_ID&quot;,
    &quot;bond_dndn&quot;        =&gt; &quot;BOND_ID&quot;,
    &quot;bond_updn&quot;        =&gt; &quot;BOND_ID&quot;,
    &quot;bond_dnup&quot;        =&gt; &quot;BOND_ID&quot;,
    &quot;current&quot;          =&gt; &quot;HOPPING_ID&quot;,
    &quot;current_upup&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;current_dndn&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;current_updn&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;current_dnup&quot;     =&gt; &quot;HOPPING_ID&quot;,
    &quot;phonon_greens&quot;    =&gt; &quot;PHONON_ID&quot;
)</code></pre><p>List of all the correlation functions that can be measured, along with the corresponding type of ID the correlation measurement is reported in terms of. Correlation functions are well defined in both position and momentum space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/measurement_names.jl#L5-L37">source</a></section></article><h3 id="Initialize-Measurements"><a class="docs-heading-anchor" href="#Initialize-Measurements">Initialize Measurements</a><a id="Initialize-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-Measurements" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_measurement_container" href="#SmoQyDQMC.initialize_measurement_container"><code>SmoQyDQMC.initialize_measurement_container</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_measurement_container(
    model_geometry::ModelGeometry{D,T,N},
    β::T, Δτ::T
) where {T&lt;:AbstractFloat, D, N}</code></pre><p>Initialize and return a measurement container of type <code>NamedTuple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_measurements!" href="#SmoQyDQMC.initialize_measurements!"><code>SmoQyDQMC.initialize_measurements!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_measurements!(
    measurement_container::NamedTuple,
    tight_binding_model_up::TightBindingModel{T,E},
    tight_binding_model_dn::TightBindingModel{T,E},
) where {T&lt;:Number, E&lt;:AbstractFloat}

initialize_measurements!(
    measurement_container::NamedTuple,
    tight_binding_model::TightBindingModel{T,E}
) where {T&lt;:Number, E&lt;:AbstractFloat}</code></pre><p>Initialize tight-binding model related measurements.</p><p><strong>Initialized Measurements</strong></p><ul><li><code>onsite_energy</code>: Refer to <a href="#SmoQyDQMC.measure_onsite_energy"><code>measure_onsite_energy</code></a>.</li><li><code>onsite_energy_up</code>: Refer to <a href="#SmoQyDQMC.measure_onsite_energy"><code>measure_onsite_energy</code></a>.</li><li><code>onsite_energy_dn</code>: Refer to <a href="#SmoQyDQMC.measure_onsite_energy"><code>measure_onsite_energy</code></a>.</li><li><code>hopping_energy</code>: Refer to <a href="#SmoQyDQMC.measure_hopping_energy"><code>measure_hopping_energy</code></a>.</li><li><code>hopping_energy_up</code>: Refer to <a href="#SmoQyDQMC.measure_hopping_energy"><code>measure_hopping_energy</code></a>.</li><li><code>hopping_energy_dn</code>: Refer to <a href="#SmoQyDQMC.measure_hopping_energy"><code>measure_hopping_energy</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L87-L109">source</a></section><section><div><pre><code class="language-julia hljs">initialize_measurements!(
    measurement_container::NamedTuple,
    hubbard_model::HubbardModel{T}
) where {T&lt;:AbstractFloat}</code></pre><p>Initialize Hubbard model related measurements.</p><p><strong>Initialized Measurements:</strong></p><ul><li><code>hubbard_energy</code>: Refer to <a href="#SmoQyDQMC.measure_hopping_energy"><code>measure_hopping_energy</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L175-L186">source</a></section><section><div><pre><code class="language-julia hljs">initialize_measurements!(
    measurement_container::NamedTuple,
    electron_phonon_model::ElectronPhononModel{T, E, D}
) where {T&lt;:Number, E&lt;:AbstractFloat, D}</code></pre><p>Initialize electron-phonon model related measurements.</p><p><strong>Initialized Measurements:</strong></p><ul><li><code>phonon_kinetic_energy</code>: Refer to <a href="#SmoQyDQMC.measure_phonon_kinetic_energy"><code>measure_phonon_kinetic_energy</code></a>.</li><li><code>phonon_potential_energy</code>: Refer to <a href="#SmoQyDQMC.measure_phonon_potential_energy"><code>measure_phonon_potential_energy</code></a>.</li><li><code>X</code>: Measure <span>$\langle \hat{X} \rangle$</span>, refer to <a href="#SmoQyDQMC.measure_phonon_position_moment"><code>measure_phonon_position_moment</code></a>.</li><li><code>X2</code>: Measure <span>$\langle \hat{X}^2 \rangle$</span>, refer to <a href="#SmoQyDQMC.measure_phonon_position_moment"><code>measure_phonon_position_moment</code></a>.</li><li><code>X3</code>: Measure <span>$\langle \hat{X}^3 \rangle$</span>, refer to <a href="#SmoQyDQMC.measure_phonon_position_moment"><code>measure_phonon_position_moment</code></a>.</li><li><code>X4</code>: Measure <span>$\langle \hat{X}^4 \rangle$</span>, refer to <a href="#SmoQyDQMC.measure_phonon_position_moment"><code>measure_phonon_position_moment</code></a>.</li><li><code>holstein_energy</code>: Refer to <a href="#SmoQyDQMC.measure_holstein_energy"><code>measure_holstein_energy</code></a>.</li><li><code>holstein_energy_up</code>: Refer to <a href="#SmoQyDQMC.measure_holstein_energy"><code>measure_holstein_energy</code></a>.</li><li><code>holstein_energy_dn</code>: Refer to <a href="#SmoQyDQMC.measure_holstein_energy"><code>measure_holstein_energy</code></a>.</li><li><code>ssh_energy</code>: Refer to <a href="#SmoQyDQMC.measure_ssh_energy"><code>measure_ssh_energy</code></a>.</li><li><code>ssh_energy_up</code>: Refer to <a href="#SmoQyDQMC.measure_ssh_energy"><code>measure_ssh_energy</code></a>.</li><li><code>ssh_energy_dn</code>: Refer to <a href="#SmoQyDQMC.measure_ssh_energy"><code>measure_ssh_energy</code></a>.</li><li><code>ssh_sgn_switch_up</code>: Refer to <a href="#SmoQyDQMC.measure_ssh_sgn_switch"><code>measure_ssh_sgn_switch</code></a>.</li><li><code>ssh_sgn_switch_dn</code>: Refer to <a href="#SmoQyDQMC.measure_ssh_sgn_switch"><code>measure_ssh_sgn_switch</code></a>.</li><li><code>dispersion_energy</code>: Refer to <a href="#SmoQyDQMC.measure_dispersion_energy"><code>measure_dispersion_energy</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L203-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_correlation_measurements!" href="#SmoQyDQMC.initialize_correlation_measurements!"><code>SmoQyDQMC.initialize_correlation_measurements!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_correlation_measurements!(;
    measurement_container::NamedTuple,
    model_geometry::ModelGeometry{D,T,N},
    correlation::String,
    pairs::AbstractVector{NTuple{2,Int}},
    time_displaced::Bool,
    integrated::Bool = false
)  where {T&lt;:AbstractFloat, D, N}</code></pre><p>Initialize measurements of <code>correlation</code> for all ID pairs; refer to <a href="#SmoQyDQMC.CORRELATION_FUNCTIONS"><code>CORRELATION_FUNCTIONS</code></a> for ID type associated with each correlation measurement. The name <code>correlation</code> must therefore also appear in [<code>CORRELATION_FUNCTIONS</code>]@ref. If <code>time_displaced = true</code> then time-displaced and integrated correlation measurements are made. If <code>time_displaced = false</code> and <code>integrated = false</code>, then just equal-time correlation measurements are made. If <code>time_displaced = false</code> and <code>integrated = true</code>, then both equal-time and integrated correlation measurements are made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L319-L335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_composite_correlation_measurement!" href="#SmoQyDQMC.initialize_composite_correlation_measurement!"><code>SmoQyDQMC.initialize_composite_correlation_measurement!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_composite_correlation_measurement!(;
    measurement_container::NamedTuple,
    model_geometry::ModelGeometry{D,T,N},
    name::String,
    correlation::String,
    ids,
    coefficients,
    time_displaced::Bool,
    integrated::Bool = false
)  where {T&lt;:AbstractFloat, D, N}</code></pre><p>Initialize a composite correlation measurement called <code>name</code> based on a linear combination of local operators used in a standard <code>correlation</code> measurement, with <code>ids</code> and <code>coefficients</code> specifying the linear combination. Note that when calculating the fourier transform of the composite correlation function measured in real space, it is assumed that the basis vector for the composite correlation operator is <span>$\mathbf{r} = 0$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L420-L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.initialize_measurement_directories" href="#SmoQyDQMC.initialize_measurement_directories"><code>SmoQyDQMC.initialize_measurement_directories</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_measurement_directories(;
    simulation_info::SimulationInfo,
    measurement_container::NamedTuple
)

initialize_measurement_directories(;
    # Keyword Arguments
    simulation_info::SimulationInfo,
    measurement_container::NamedTuple
)</code></pre><p>Initialize the measurement directories for simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/initialize_measurements.jl#L482-L495">source</a></section></article><h3 id="Make-Measreuments"><a class="docs-heading-anchor" href="#Make-Measreuments">Make Measreuments</a><a id="Make-Measreuments-1"></a><a class="docs-heading-anchor-permalink" href="#Make-Measreuments" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.make_measurements!" href="#SmoQyDQMC.make_measurements!"><code>SmoQyDQMC.make_measurements!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_measurements!(
    measurement_container::NamedTuple,
    logdetGup::E, sgndetGup::T, Gup::AbstractMatrix{T},
    Gup_ττ::AbstractMatrix{T}, Gup_τ0::AbstractMatrix{T}, Gup_0τ::AbstractMatrix{T},
    logdetGdn::E, sgndetGdn::T, Gdn::AbstractMatrix{T},
    Gdn_ττ::AbstractMatrix{T}, Gdn_τ0::AbstractMatrix{T}, Gdn_0τ::AbstractMatrix{T};
    # Keyword Arguments Start Here
    fermion_path_integral_up::FermionPathIntegral{T,E},
    fermion_path_integral_dn::FermionPathIntegral{T,E},
    fermion_greens_calculator_up::FermionGreensCalculator{T,E},
    fermion_greens_calculator_dn::FermionGreensCalculator{T,E},
    Bup::Vector{P}, Bdn::Vector{P}, δG_max::E, δG::E, δθ::E,
    model_geometry::ModelGeometry{D,E,N},
    tight_binding_parameters::Union{Nothing, TightBindingParameters{T,E}} = nothing,
    tight_binding_parameters_up::Union{Nothing, TightBindingParameters{T,E}} = nothing,
    tight_binding_parameters_dn::Union{Nothing, TightBindingParameters{T,E}} = nothing,
    coupling_parameters::Tuple
) where {T&lt;:Number, E&lt;:AbstractFloat, D, N, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Make measurements, including time-displaced correlation and zero Matsubara frequency measurements. This method also returns <code>(logdetGup, sgndetGup, logdetGdn, sgndetGdn, δG, δθ)</code>. Note that either the keywork <code>tight_binding_parameters</code> needs to be specified, or <code>tight_binding_parameters_up</code> and <code>tight_binding_parameters_dn</code> both need to be specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/make_measurements.jl#L5-L29">source</a></section><section><div><pre><code class="language-julia hljs">make_measurements!(
    measurement_container::NamedTuple,
    logdetG::E, sgndetG::T, G::AbstractMatrix{T},
    G_ττ::AbstractMatrix{T}, G_τ0::AbstractMatrix{T}, G_0τ::AbstractMatrix{T};
    # Keyword Arguments Start Here
    fermion_path_integral::FermionPathIntegral{T,E},
    fermion_greens_calculator::FermionGreensCalculator{T,E},
    B::Vector{P}, δG_max::E, δG::E, δθ::E,
    model_geometry::ModelGeometry{D,E,N},
    tight_binding_parameters::TightBindingParameters{T,E},
    coupling_parameters::Tuple
) where {T&lt;:Number, E&lt;:AbstractFloat, D, N, P&lt;:AbstractPropagator{T,E}}</code></pre><p>Make measurements, including time-displaced correlation and zero Matsubara frequency measurements. This method also returns <code>(logdetG, sgndetG, δG, δθ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/make_measurements.jl#L196-L212">source</a></section></article><h3 id="Write-Measreuments"><a class="docs-heading-anchor" href="#Write-Measreuments">Write Measreuments</a><a id="Write-Measreuments-1"></a><a class="docs-heading-anchor-permalink" href="#Write-Measreuments" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.write_measurements!" href="#SmoQyDQMC.write_measurements!"><code>SmoQyDQMC.write_measurements!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_measurements!(;
    measurement_container::NamedTuple,
    simulation_info::SimulationInfo,
    model_geometry::ModelGeometry{D, E, N},
    bin::Int, bin_size::Int, Δτ::E
) where {D, E&lt;:AbstractFloat, N}</code></pre><p>Write the measurements contained in <code>measurement_container</code> to file. Measurements are written to file in a binary format using the <a href="https://github.com/JuliaIO/JLD2.jl.git"><code>JLD2.jl</code></a> package.</p><p>This function also does a few other things:</p><ol><li>Normalizes all the measurements by the <code>bin_size</code> i.e. the number of measurements that were accumlated into the measurement container.</li><li>Take position space correlation function measurements and fourier transform them to momentum space.</li><li>Integrate relevant time-displaced correlation function measurements over imaginary time to get the corresponding zero matsubara frequency correlation function.</li><li>Reset all the measurements in <code>measurement_container</code> to zero after the measurements are written to file.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/write_measurements.jl#L5-L21">source</a></section></article><h3 id="Process-Measurements"><a class="docs-heading-anchor" href="#Process-Measurements">Process Measurements</a><a id="Process-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Process-Measurements" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.save_simulation_info" href="#SmoQyDQMC.save_simulation_info"><code>SmoQyDQMC.save_simulation_info</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_simulation_info(sim_info::SimulationInfo, additional_info = nothing)</code></pre><p>Save the contents <code>sim_info</code> to a TOML file, and add an optional additional table to the output file based on the contents of a dictionary <code>additional_info</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/SimulationInfo.jl#L86-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.process_measurements" href="#SmoQyDQMC.process_measurements"><code>SmoQyDQMC.process_measurements</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_measurements(
    # ARGUMENTS
    folder::String,
    N_bins::Int,
    pIDs::Union{Vector{Int},Int} = Int[];
    # KEYWORD ARGUMENTS
    time_displaced::Bool = false
)

process_measurements(
    # ARGUMENTS
    comm::MPI.Comm,
    folder::String,
    N_bins::Int,
    pIDs::Union{Vector{Int},Int} = Int[];
    # KEYWORD ARGUMENTS
    time_displaced::Bool = false
)</code></pre><p>Process the measurements recorded in the simulation directory <code>folder</code>, where <code>N_bins</code> is the number of bins the data is grouped into for calculating error bars. Note that this method will over-write an existing correlation stats file if there already is one. The boolean flag <code>time_displaced</code> determines whether or not to calculate error bars for time-displaced correlation measurements, as this can take a non-negligible amount of time for large system, especially when many simulations were run in parallel. Note that using <code>pIDs</code> argument you can filter which MPI walker to use when calculting the statistics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_measurements.jl#L5-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.process_global_measurements" href="#SmoQyDQMC.process_global_measurements"><code>SmoQyDQMC.process_global_measurements</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_global_measurements(
    folder::String,
    N_bins::Int,
    pIDs::Union{Vector{Int},Int} = Int[]
)

process_global_measurements(
    comm::MPI.Comm,
    folder::String,
    N_bins::Int,
    pIDs::Vector{Int} = Int[]
)</code></pre><p>Process global measurents for the specified process IDs, calculating the average and error for all global measurements and writing the result to CSV file. If <code>pIDs</code> is not specified, then results for all MPI walkers are averaged over.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_global_measurements.jl#L5-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.process_local_measurements" href="#SmoQyDQMC.process_local_measurements"><code>SmoQyDQMC.process_local_measurements</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_local_measurements(
    folder::String,
    N_bins::Int,
    pIDs::Union{Vector{Int},Int} = Int[]
)

process_local_measurements(
    comm::MPI.Comm,
    folder::String,
    N_bins::Int,
    pIDs::Vector{Int} = Int[]
)</code></pre><p>Process local measurents for the specified process IDs, calculating the average and error for all local measurements and writing the result to CSV file. If <code>pIDs</code> is not specified, then the statistics are calculated using all MPI walker results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_local_measurements.jl#L5-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.process_correlation_measurements" href="#SmoQyDQMC.process_correlation_measurements"><code>SmoQyDQMC.process_correlation_measurements</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_correlation_measurements(
    folder::String,
    N_bins::Int,
    pIDs::Union{Vector{Int},Int} = Int[],
    types::Vector{String} = [&quot;equal-time&quot;, &quot;time-displaced&quot;, &quot;integrated&quot;],
    spaces::Vector{String} = [&quot;position&quot;, &quot;momentum&quot;]
)

function process_correlation_measurements(
    comm::MPI.Comm,
    N_bins::Int,
    pIDs::Vector{Int} = Int[],
    types::Vector{String} = [&quot;equal-time&quot;, &quot;time-displaced&quot;, &quot;integrated&quot;],
    spaces::Vector{String} = [&quot;position&quot;, &quot;momentum&quot;]
)</code></pre><p>Process correlation measurements, calculating the average and errors and writing the result to CSV file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_correlation_measurements.jl#L5-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.process_correlation_measurement" href="#SmoQyDQMC.process_correlation_measurement"><code>SmoQyDQMC.process_correlation_measurement</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_correlation_measurement(
    folder::String,
    correlation::String,
    type::String,
    space::String,
    N_bins::Int,
    pIDs::Union{Vector{Int}, Int} = Int[]
)</code></pre><p>Process results for the specified correlation function, calculating the associated average and error statistics for it and writing the result to CSV file. If <code>pIDs</code> is not specified, then the calculated statistics are arrived at by averaging over the results for all MPI walkers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_correlation_measurements.jl#L178-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.composite_correlation_stat" href="#SmoQyDQMC.composite_correlation_stat"><code>SmoQyDQMC.composite_correlation_stat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">composite_correlation_stat(;
    folder::String,
    correlations::Vector{String},
    spaces::Vector{String},
    types::Vector{String},
    ids::Vector{NTuple{2,Int}},
    locs::Vector{NTuple{D,Int}},
    Δls::Vector{Int} = Int[],
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
    f::Function = identity
) where {D}

function composite_correlation_stat(
    comm::MPI.Comm;
    # Keyword Arguments Below
    folder::String,
    correlations::Vector{String},
    spaces::Vector{String},
    types::Vector{String},
    ids::Vector{NTuple{2,Int}},
    locs::Vector{NTuple{D,Int}},
    Δls::Vector{Int} = Int[],
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
    f::Function = identity
) where {D}</code></pre><p>Calaculate the mean and error for a composite correlation measurement based on the function <code>f</code>. Note that <code>D</code> indicates the spatial dimension of the system.</p><p><strong>Keywords</strong></p><ul><li><code>folder::String</code>: The directory all the simulation results were written to.</li><li><code>correlations::Vector{String}</code>: Vector specifying the correlation types.</li><li><code>spaces::Vector{String}:</code> Space of each correlation measurement <code>&quot;position&quot;</code> or <code>&quot;momentum&quot;</code>.</li><li><code>types::Vector{String}</code>: The type of each correlation measurement <code>&quot;equal-time&quot;</code>, <code>&quot;time-displaced&quot;</code> or <code>&quot;integrated&quot;</code>.</li><li><code>ids::Vector{NTuple{2,Int}}</code>: Vector of ID pairs to read for each correlation.</li><li><code>locs::Vector{NTuple{D,Int}}</code>: Species displacement vector for position space, or k-point for momentum space.</li><li><code>Δls::Vector{Int} = Int[]</code>: Displacement in imaginary time for time-displaced correlation measurements. Igonored otherwise.</li><li><code>num_bins::Int = 0</code>: Number of bins used to calcuate error for each MPI walker, defaults to the number of JLD2 binary data files.</li><li><code>pIDs::Vector{Int} = Int[]</code>: MPI walkers to average over when calculating states, defaults to using all MPI walkers if not specified.</li><li><code>f::Function = identity</code>: Function evaluated to calculate the composite correlation that is measured.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_composite_correlation.jl#L1-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.compute_correlation_ratio" href="#SmoQyDQMC.compute_correlation_ratio"><code>SmoQyDQMC.compute_correlation_ratio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_correlation_ratio(
    comm::MPI.Comm;
    folder::String,
    correlation::String,
    type::String,
    ids,
    id_pairs::Vector{NTuple{2,Int}} = NTuple{2,Int}[],
    coefs,
    k_point,
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
)

compute_correlation_ratio(;
    # Keyword Arguments
    folder::String,
    correlation::String,
    type::String,
    ids,
    id_pairs::Vector{NTuple{2,Int}} = NTuple{2,Int}[],
    coefs,
    k_point,
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
)</code></pre><p>Compute the correlation ratio at the <span>$\mathbf{k}$</span>-point using a linear combination of standard correlation function measurements. The linear combination of correlation functions used is defined by <code>id_pairs</code> and <code>coefs</code>. If <code>id_pairs</code> is empty, then all possible combinations of ID pairs are construct based passed <code>ids</code>, with coefficients similarly expanded out. If <code>type</code> is <code>&quot;equal-time&quot;</code> or <code>&quot;time-displaced&quot;</code> then the equal-time correlation ratio is calculated. If <code>type</code> is &quot;integrated&quot; then the integrated correlation ratio is calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_correlation_ratio.jl#L1-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.compute_composite_correlation_ratio" href="#SmoQyDQMC.compute_composite_correlation_ratio"><code>SmoQyDQMC.compute_composite_correlation_ratio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_composite_correlation_ratio(
    comm::MPI.Comm;
    # Keyword Arguments
    folder::String,
    correlation::String,
    type::String,
    k_point,
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
)

compute_composite_correlation_ratio(;
    # Keyword Arguments
    folder::String,
    correlation::String,
    type::String,
    k_point,
    num_bins::Int = 0,
    pIDs::Vector{Int} = Int[],
)</code></pre><p>Compute the correlation ratio for a specified <span>$\mathbf{k}$</span>-point for the specified composite <code>correlation</code> function. If <code>type</code> is <code>&quot;equal-time&quot;</code> or <code>&quot;time-displaced&quot;</code> then the equal-time correlation ratio is calculated. If <code>type</code> is &quot;integrated&quot; then the integrated correlation ratio is calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/process_correlation_ratio.jl#L247-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.global_measurement_bins_to_csv" href="#SmoQyDQMC.global_measurement_bins_to_csv"><code>SmoQyDQMC.global_measurement_bins_to_csv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">global_measurement_bins_to_csv(
    folder::String,
    pID::Int = -1
)</code></pre><p>Write the binned global measurements to file corresponding to process ID <code>pID</code>. If <code>pID = -1</code>, then write binned global measurements for all processes to file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/binned_data_to_csv.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.local_measurement_bins_to_csv" href="#SmoQyDQMC.local_measurement_bins_to_csv"><code>SmoQyDQMC.local_measurement_bins_to_csv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">local_measurement_bins_to_csv(
    folder::String,
    measurement::String,
    pID::Int = -1
)</code></pre><p>Write the binned values for the local measurement <code>measurement</code> to a CSV file for process ID <code>pID</code>. If <code>pID = -1</code>, then write it to file for all process IDs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/binned_data_to_csv.jl#L91-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.correlation_bins_to_csv" href="#SmoQyDQMC.correlation_bins_to_csv"><code>SmoQyDQMC.correlation_bins_to_csv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correlation_bins_to_csv(
    pID::Int = -1;
    folder::String,
    correlation::String,
    type::String,
    space::String,
    write_index_key::Bool = true
)</code></pre><p>Write binned <code>correlation</code> data for <code>pID</code> to a CSV file. The field <code>type</code> must be set equal to <code>&quot;equal-time&quot;</code>, <code>&quot;time-displaced&quot;</code> or <code>&quot;integrated&quot;</code>, and the field <code>space</code> but bet set to either <code>&quot;position&quot;</code> or <code>&quot;momentum&quot;</code>. If <code>pID = -1</code>, then write binned data for all walkers to file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/binned_data_to_csv.jl#L183-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.compress_jld2_bins" href="#SmoQyDQMC.compress_jld2_bins"><code>SmoQyDQMC.compress_jld2_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compress_jld2_bins(
    # ARGUMENTS
    comm::MPI.Comm;
    # KEYWORD ARGUMENTS
    folder::String,
    pID::Int = -1,
    compress::Bool = true
)

compress_jld2_bins(;
    # KEYWORD ARGUMENTS
    folder::String,
    pID::Int = -1,
    compress::Bool = true
)</code></pre><p>Combine the many JLD2 binary files containing the binned data into a single JLD2 file. If <code>pID ≥ 0</code>, then only the binned files corresponding to the passed pID values merged into a single file <code>binned_data_pID-$(pID).jld2</code>. If <code>pID = -1</code>, then all the binned files, regardless are merged into a single filed called <code>binned_data.jld2</code>. Note that if many simulations were run in parallel, this can take quite a while, and doing it for a single <code>pID</code> at a time may be advisable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/compress_decompress_bins.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.decompress_jld2_bins" href="#SmoQyDQMC.decompress_jld2_bins"><code>SmoQyDQMC.decompress_jld2_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decompress_jld2_bins(;
    # KEYWORD ARGUMENTS
    folder::String,
    pID::Int = -1
)</code></pre><p>Decompress compressed binned data stored in a single JLD2 file into the original population of many JLD2 files, eaching containing the binned data for a certain type of measurement. If <code>pID ≥ 0</code>, then the file <code>binary_data_pID-$(pID).jld2</code> will be decompressed. If <code>pID = -1</code>, then the file <code>binary_data.jld2</code> will be decompressed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/compress_decompress_bins.jl#L99-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoQyDQMC.delete_jld2_bins" href="#SmoQyDQMC.delete_jld2_bins"><code>SmoQyDQMC.delete_jld2_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_jld2_bins(;
    # KEYWORD ARGUMENTS
    folder::String,
    pID::Int = -1
)</code></pre><p>Go through and delete all the binary files in the data folder directory. Please be cautious, once done this operation cannot be undone, data will be lost permanently!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SmoQySuite/SmoQyDQMC.jl/blob/3144478f9fd45c67cf30aed34d2b3fae5406a2d8/src/Measurements/compress_decompress_bins.jl#L154-L163">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simulation_output/">« Simulation Output Overview</a><a class="docs-footer-nextpage" href="../tutorials/hubbard_chain/">Tutorial 1: Hubbard Chain »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 7 October 2024 19:49">Monday 7 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
