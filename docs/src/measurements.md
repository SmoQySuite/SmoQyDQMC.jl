# Measurement Definitions

In this section we define and review the various types of measurements that can be reported
by a [SmoQyDQMC.jl](https://github.com/SmoQySuite/SmoQyDQMC.jl) DQMC simulation.

Note that the average value for all measured quantities are reported as complex number, even if they are know to be strictly real formally.
On the other hand, the error, or standard deviation, associated with every measurement is reported as a strictly positive real number such that
the error associated with the complex expectation value ``\langle C \rangle``
is given by ``\Delta C = \sqrt{\Delta C_{\rm Re}^2 + \Delta C_{\rm Im}^2}``.

## Model Summary

The function [`model_summary`](@ref) is used to a TOML file named `model_summary.toml` that full describes
and parameterizes the Hamiltonian simulated in a DQMC simulation using [`SmoQyDQMC.jl`](https://github.com/SmoQySuite/SmoQyDQMC.jl).
Significantly, this method also defines the types of IDs
(`ORBITAL_ID`, `BOND_ID`, `HOPPING_ID`, `PHONON_ID`, `HOLSTEIN_ID`, `SSH_ID`, `DISPERSION_ID`) that
the various measurements are reported in terms of. The type of ID used to report correlation and local measurements are recorded in
the exported dictionaries [`CORRELATION_FUNCTIONS`](@ref) and [`LOCAL_MEASUREMENTS`](@ref).

## Global Measurements

At the end of a simulation once the measurements are processed using the [`process_measurements`](@ref)
method, a file `global_stats.csv` file is created that contains the final estimates and errors for all "global" measurements.
The corresponding binned global data is stored as binary JLD2 files in the directory `global` inside the simulation directory.
We define each global measurement below.

- `sgn`: The average sign ``\mathcal{S} = \langle {\rm sign}( \det G_\uparrow \cdot \det G_\downarrow ) \rangle``.
- `sgndetGup`: The average spin-up sign ``\mathcal{S}_\uparrow = \langle {\rm sign}(\det G_\uparrow) \rangle``.
- `sgndetGdn`: The average spin-up sign ``\mathcal{S}_\downarrow = \langle {\rm sign}(\det G_\downarrow) \rangle``.
- `density`: Average global total charge density ``\langle n \rangle = \langle n_\uparrow \rangle + \langle n_\downarrow \rangle``.
- `double_occ`: Average global double occupancy ``\langle n_\uparrow n_\downarrow \rangle``.
- `Nsqrd`: Expectation value for total electron number squared ``\langle N^2 \rangle``, where ``\hat{N} = \sum_{\sigma,\mathbf{i},\nu} \hat{n}_{\sigma, \mathbf{i}, \nu}``.
- `chemical_potential`: The measured chemical potential ``\mu``.
- `compressibility`: The measured compressibility ``\kappa = \frac{d \langle n \rangle}{d \mu} = \frac{\beta}{\mathcal{N}}\left( \langle N^2 \rangle - \langle N \rangle^2 \right)``.

## Local Measurement

At the end of a simulation once the measurements are processed using the [`process_measurements`](@ref)
method, a file `local_stats.csv` file is created that contains the final estimates and errors for all "local" measurements.
The corresponding binned local data is stored as binary JLD2 files in the directory `local` inside the simulation directory.
All "local" measurements are reported in terms of an ID type, defined in the `model_summary.toml` file generated by
the [`model_summary`](@ref) function. The definition for each local measurement that may be reported,
including the type of ID it is reported in terms of, is defined below.

- `density`: (`ORBITAL_ID`) The charge density ``\langle n_{\nu} \rangle = \langle n_{\uparrow,\nu} \rangle + \langle n_{\downarrow,\nu} \rangle`` for orbital ``\nu`` in the unit cell.
- `double_occ`: (`ORBITAL_ID`) The double-occupance ``\langle n_{\uparrow,\nu} n_{\downarrow,\nu} \rangle`` for orbital ``\nu`` in the unit cell.

### Local Tight-Binding Measurements

- `onsite_energy`: (`ORBITAL_ID`) The on-site energy ``(\epsilon_\nu - \mu) \langle n_\nu \rangle`` for orbital ``\nu`` in the unit cell.
- `hopping_energy`: (`HOPPING_ID`) The hopping energy ``-\sum_{\sigma,\mathbf{i}} \langle t_{(\mathbf{i}+\mathbf{r},\nu),(\mathbf{i},\gamma)} c^\dagger_{\sigma,\mathbf{i}+\mathbf{r},\nu} c^{\phantom\dagger}_{\sigma,\mathbf{i},\gamma} + {\rm h.c.} \rangle`` for a hopping connecting orbitals ``\gamma`` and ``\nu`` displaced ``\mathbf{r}`` unit cells, where ``t_{(\mathbf{i}+\mathbf{r},\nu),(\mathbf{i},\gamma)}`` is the bare hopping amplitude.

### Local Hubbard Measurements

- `hubbard_energy`: (`ORBITAL_ID`) The Hubbard interaction energy ``U_{\nu} \langle n_{\uparrow,\nu} n_{\downarrow,\nu} \rangle`` for orbital ``\nu`` in the unit cell.

### Local Phonon Measurements

- `phonon_kin_energy`: (`PHONON_ID`) The phonon kinetic energy ``\frac{1}{2 M_{n_{\nu}}} \langle P_{n_{\nu}}^2 \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `phonon_pot_energy`: (`PHONON_ID`) The phonon potential energy ``\frac{1}{2}M_{n_{\nu}}\Omega_{0,n_{\nu}}^2\langle X_{n_{\nu}}^2 \rangle + \frac{1}{24}M_{n_{\nu}}\Omega_{a,n_{\nu}}^2\langle X_{n_{\nu}}^4 \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `X`: (`PHONON_ID`): The expecation values ``\langle X_{n_\nu} \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `X2`: (`PHONON_ID`): The expecation values ``\langle X_{n_\nu}^2 \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `X3`: (`PHONON_ID`): The expecation values ``\langle X_{n_\nu}^3 \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `X4`: (`PHONON_ID`): The expecation values ``\langle X_{n_\nu}^4 \rangle`` for phonon mode ``n_{\nu}`` in unit cell.
- `dispersion_energy`: (`DISPERSION_ID`) The dispersion energy ``\langle \mathcal{U}_{{\rm disp.}, \mathbf{r}, n_\nu, n_\gamma} \rangle`` between the two phonon models ``n_\nu`` and ``n_\gamma`` displaced ``\mathbf{r}`` unit cells from eachother.

### Local Electron-Phonon Interaction Measurements

- `holstein_energy`: (`HOLSTEIN_ID`) The Holstein interaction energy ``\tilde{\alpha}_{n_{\mathbf{i},\nu},(\mathbf{i}+\mathbf{r},\gamma)} \langle X_{n_{\mathbf{i},\nu}} (n_{\mathbf{i}+\mathbf{r},\gamma} - 1) \rangle`` between a phonon mode ``n_{\mathbf{i},\nu}`` and total charge density on orbital ``\gamma`` displaced ``\mathbf{r}`` unit cells away.